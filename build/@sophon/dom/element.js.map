{"version":3,"file":"element.js","sources":["../../../libs/dom/src/element.ts"],"sourcesContent":["import { REvent } from '@sophon/base';\nimport { RNode } from './node';\nimport { RAttributeChangeEvent } from './events';\nimport { RNodeList, RStaticNodeList } from './nodelist';\nimport type {GUI} from './gui';\n\nexport interface RClassList {\n  [n: number]: string;\n}\n\nexport class RClassList {\n  /** @internal */\n  private static _elementMap: WeakMap<RClassList, RElement> = new WeakMap();\n  /** @internal */\n  private _classList: string[];\n  /** @internal */\n  private _value: string;\n  /** @internal */\n  private _valueChanged: boolean;\n  /** @internal */\n  private _changeEvent: RAttributeChangeEvent;\n  constructor(el: RElement) {\n    this._classList = [];\n    this._value = '';\n    this._valueChanged = false;\n    this._changeEvent = new RAttributeChangeEvent('class', false);\n    const proxy = new Proxy(this, {\n      get: function (target, name) {\n        if (typeof name === 'string' && /^\\d+$/.test(name)) {\n          return target._classList[parseInt(name)];\n        } else {\n          return target[name];\n        }\n      },\n    });\n    RClassList._elementMap.set(proxy, el);\n    return proxy;\n  }\n  get value(): string {\n    if (this._valueChanged) {\n      this._valueChanged = false;\n      this._value = this._classList.join(' ');\n    }\n    return this._value;\n  }\n  set value(val: string) {\n    this._setValue(val, true);\n  }\n  get length(): number {\n    return this._classList.length;\n  }\n  /** @internal */\n  _setValue(val: string, dispatch: boolean) {\n    this._classList = val.split(/\\s+/).filter((value) => !!value);\n    this._valueChanged = true;\n    if (dispatch) {\n      this._notify();\n    }\n  }\n  /** @internal */\n  _notify() {\n    const el = RClassList._elementMap.get(this);\n    el.dispatchEvent(this._changeEvent);\n  }\n  add(...args: string[]) {\n    let changed = false;\n    for (const arg of args) {\n      if (arg && typeof arg === 'string') {\n        const classes = arg.split(/\\s+/);\n        classes.forEach((cls) => {\n          if (this._classList.indexOf(cls) < 0) {\n            this._classList.push(cls);\n            changed = true;\n          }\n        });\n      }\n    }\n    if (changed) {\n      this._valueChanged = true;\n      this._notify();\n    }\n  }\n  remove(...args: string[]) {\n    let changed = false;\n    for (const arg of args) {\n      if (arg && typeof arg === 'string') {\n        const classes = arg.split(/\\s+/);\n        classes.forEach((cls) => {\n          const index = this._classList.indexOf(cls);\n          if (index >= 0) {\n            this._classList.splice(index, 1);\n            changed = true;\n          }\n        });\n      }\n    }\n    if (changed) {\n      this._valueChanged = true;\n      this._notify();\n    }\n  }\n  toggle(className: string): boolean {\n    this._valueChanged = true;\n    const index = this._classList.indexOf(className);\n    if (index >= 0) {\n      this._classList.splice(index, 1);\n      this._notify();\n      return false;\n    } else {\n      this._classList.push(className);\n      this._notify();\n      return true;\n    }\n  }\n  contains(className: string): boolean {\n    return this._classList.indexOf(className) >= 0;\n  }\n  replace(oldClassName: string, newClassName: string) {\n    if (newClassName !== oldClassName) {\n      if (!oldClassName || oldClassName.indexOf(' ') >= 0) {\n        throw new Error('Failed to replace class: old class name is invalid');\n      }\n      oldClassName = oldClassName.trim();\n      if (oldClassName === '') {\n        throw new Error('Failed to replace class: old class name is empty');\n      }\n      const index = this._classList.indexOf(oldClassName);\n      if (index < 0) {\n        throw new Error('Failed to replace class: old class name not exists');\n      }\n      newClassName = newClassName || '';\n      newClassName = newClassName.trim();\n      const newClassNames = newClassName.split(/\\s+/).filter((val) => !!val);\n      this._classList.splice(index, 1, ...newClassNames);\n\n      this._notify();\n    }\n  }\n}\n\nexport interface RAttr {\n  name: string;\n  value: string;\n}\n\nexport class RElement extends RNode {\n  /** @internal */\n  protected _tagname: string;\n  /** @internal */\n  protected _attributes: {[name: string]: string};\n  /** @internal */\n  protected _classList: RClassList;\n  /** @internal */\n  protected _attrChangeEvent: RAttributeChangeEvent;\n  constructor(uiscene: GUI) {\n    super(uiscene);\n    this._tagname = null;\n    this._attributes = {};\n    this._classList = new RClassList(this);\n    this._attrChangeEvent = new RAttributeChangeEvent('', false);\n    this.addDefaultEventListener(RAttributeChangeEvent.NAME, (e: REvent) => {\n      const data = e as RAttributeChangeEvent;\n      if (data.name === 'class') {\n        this._uiscene._markStyleRefreshForElement(this);\n      }\n    });\n  }\n  get children(): RNodeList {\n    return this._childrenElements;\n  }\n  get childElementCount(): number {\n    return this._childrenElements.length;\n  }\n  get nodeType(): number {\n    return RNode.ELEMENT_NODE;\n  }\n  get localName(): string {\n    return this._tagname;\n  }\n  get tagName(): string {\n    return this._tagname;\n  }\n  get id(): string {\n    return this._attributes.id || '';\n  }\n  set id(id: string) {\n    this._attributes.id = id || '';\n  }\n  get classList(): RClassList {\n    return this._classList;\n  }\n  get className(): string {\n    return this._classList.value;\n  }\n  get attributes(): RAttr[] {\n    const result: RAttr[] = [];\n    for (const name in this._attributes) {\n      result.push({name: name, value: this._attributes[name]});\n    }\n    return result;\n  }\n  get firstElementChild(): RElement {\n    return this._getFirstChild(true) as RElement;\n  }\n  get lastElementChild(): RElement {\n    return this._getLastChild(true) as RElement;\n  }\n  get nextElementSibling(): RElement {\n    return this._getNextSibling(true) as RElement;\n  }\n  get previousElementSibling(): RElement {\n    return this._getPreviousSibling(true) as RElement;\n  }\n  getAttribute(k: string): string {\n    if (k) {\n      k = k.toLowerCase();\n      return k === 'class'\n        ? this._classList.value\n        : (this._attributes && this._attributes[k]) || null;\n    }\n    return null;\n  }\n  setAttribute(k: string, v?: string) {\n    if (k) {\n      v = v || null;\n      k = k.toLowerCase();\n      if (this._attributes[k] !== v) {\n        this._attributes[k] = v;\n        if (k === 'class') {\n          this._classList._setValue(v || '', false);\n        } else if (k === 'style') {\n          this._uiscene._markStyleRefreshForElement(this);\n        }\n        this._attrChangeEvent.name = k;\n        this._attrChangeEvent.removed = false;\n        this.dispatchEvent(this._attrChangeEvent);\n      }\n    }\n  }\n  removeAttribute(k: string) {\n    if (k) {\n      k = k.toLowerCase();\n      if (this._attributes[k] !== undefined) {\n        delete this._attributes[k];\n        if (k === 'style') {\n          this._uiscene._markStyleRefreshForElement(this);\n        }\n        this._attrChangeEvent.name = k;\n        this._attrChangeEvent.removed = true;\n        this.dispatchEvent(this._attrChangeEvent);\n      }\n    }\n  }\n  hasAttribute(k: string): boolean {\n    return k ? this._attributes[k.toLowerCase()] !== undefined : false;\n  }\n  hasAttributes(): boolean {\n    return Object.getOwnPropertyNames(this._attributes).length !== 0;\n  }\n  insertAdjacentElement(position: string, element: RElement) {\n    if (!element) {\n      return null;\n    }\n    if (position === 'beforebegin') {\n      this.before(element);\n      return element;\n    } else if (position === 'afterend') {\n      this.after(element);\n      return element;\n    } else if (position === 'afterbegin') {\n      this.prepend(element);\n      return element;\n    } else if (position === 'beforeend') {\n      this.append(element);\n      return element;\n    }\n    return null;\n  }\n  insertAdjacentText(position: string, text: string) {\n    if (!text) {\n      return null;\n    }\n    if (position === 'beforebegin') {\n      this.before(text);\n      return text;\n    } else if (position === 'afterend') {\n      this.after(text);\n      return text;\n    } else if (position === 'afterbegin') {\n      this.prepend(text);\n      return text;\n    } else if (position === 'beforeend') {\n      this.append(text);\n      return text;\n    }\n    return null;\n  }\n  matches(selectorString: string): boolean {\n    return this.ownerDocument.querySelectorAll(selectorString).indexOf(this) >= 0;\n  }\n  cloneNode(deep: boolean): RNode {\n    const clone = this._uiscene.createElement(this.tagName);\n    clone.classList._setValue(this.classList.value, false);\n    clone._attributes = Object.assign({}, this._attributes);\n    if (deep) {\n      for (let child = this.firstChild; child; child = child.nextSibling) {\n        clone.appendChild(child.cloneNode(deep));\n      }\n    }\n    return clone;\n  }\n  replaceWith(...nodes: (RNode | string)[]): void {\n    this.before(...nodes);\n    this.remove();\n  }\n  /** @internal */\n  _updateStyle(val: string) {\n    super._updateStyle(val);\n    this._rawSetStyleAttribute(val);\n  }\n  /** @internal */\n  _applyInlineStyles() {\n    this.style.applyStyles(this.getAttribute('style') || '', true);\n  }\n  /** @internal */\n  protected _getNumberAttribute(name: string, defaultValue: number): number {\n    const val = this.getAttribute(name);\n    const num = val === null ? defaultValue : Number(val);\n    return Number.isNaN(num) ? defaultValue : num;\n  }\n  /** @internal */\n  protected _setNumberAttribute(name: string, val: number) {\n    this.setAttribute(name, String(val));\n  }\n  /** @internal */\n  protected _getStringAttribute(name: string, defaultValue: string): string {\n    const val = this.getAttribute(name);\n    return val ? String(val) : defaultValue;\n  }\n  /** @internal */\n  protected _setStringAttribute(name: string, val: string) {\n    this.setAttribute(name, String(val));\n  }\n  /** @internal */\n  _rawSetStyleAttribute(style: string) {\n    style = style || '';\n    if (this._attributes['style'] !== style) {\n      this._attributes['style'] = style;\n      this._attrChangeEvent.name = 'style';\n      this._attrChangeEvent.removed = false;\n      this.dispatchEvent(this._attrChangeEvent);\n    }\n  }\n  /** @internal */\n  _setTagName(name: string) {\n    this._tagname = name;\n  }\n  remove(): RNode {\n    this._remove();\n    return this;\n  }\n  before(...nodes: (RNode | string)[]): void {\n    this._before(...nodes);\n  }\n  after(...nodes: (RNode | string)[]): void {\n    this._after(...nodes);\n  }\n  append(...nodes: (RNode | string)[]): void {\n    this._append(...nodes);\n  }\n  prepend(...nodes: (RNode | string)[]): void {\n    this._prepend(...nodes);\n  }\n  querySelectorAll(selectors: string): RNodeList {\n    return new RStaticNodeList(this._uiscene._querySelectorAll(this, selectors, true, false));\n  }\n  querySelector<T extends RElement>(selectors: string): T {\n    return this._uiscene._querySelectorOne<T>(this, selectors, true, false);\n  }\n  getElementById(id: string): RElement {\n    for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\n      const el = this._uiscene._getElementById(child, id);\n      if (el) {\n        return el;\n      }\n    }\n    return null;\n  }\n  getElementsByTagName(tagName: string): RNodeList {\n    const results: RElement[] = [];\n    for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\n      this._uiscene._getElementsByTagName(child, tagName, results);\n    }\n    return new RStaticNodeList(results);\n  }\n  getElementsByClassName(classnames: string): RNodeList {\n    const results: RElement[] = [];\n    classnames = classnames || '';\n    const classNameList = classnames.split(/\\s+/).filter((val) => !!val);\n    if (classNameList.length > 0) {\n      for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\n        this._uiscene._getElementsByClassName(child, classNameList, results);\n      }\n    }\n    return new RStaticNodeList(results);\n  }\n}\n"],"names":[],"mappings":"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"}