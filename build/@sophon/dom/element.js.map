{"version":3,"file":"element.js","sources":["../../../libs/dom/src/element.ts"],"sourcesContent":["import { REvent } from '@sophon/base';\r\nimport { RNode } from './node';\r\nimport { RAttributeChangeEvent } from './events';\r\nimport { RNodeList, RStaticNodeList } from './nodelist';\r\nimport type {GUI} from './gui';\r\n\r\nexport interface RClassList {\r\n  [n: number]: string;\r\n}\r\n\r\nexport class RClassList {\r\n  /** @internal */\r\n  private static _elementMap: WeakMap<RClassList, RElement> = new WeakMap();\r\n  /** @internal */\r\n  private _classList: string[];\r\n  /** @internal */\r\n  private _value: string;\r\n  /** @internal */\r\n  private _valueChanged: boolean;\r\n  /** @internal */\r\n  private _changeEvent: RAttributeChangeEvent;\r\n  constructor(el: RElement) {\r\n    this._classList = [];\r\n    this._value = '';\r\n    this._valueChanged = false;\r\n    this._changeEvent = new RAttributeChangeEvent('class', false);\r\n    const proxy = new Proxy(this, {\r\n      get: function (target, name) {\r\n        if (typeof name === 'string' && /^\\d+$/.test(name)) {\r\n          return target._classList[parseInt(name)];\r\n        } else {\r\n          return target[name];\r\n        }\r\n      },\r\n    });\r\n    RClassList._elementMap.set(proxy, el);\r\n    return proxy;\r\n  }\r\n  get value(): string {\r\n    if (this._valueChanged) {\r\n      this._valueChanged = false;\r\n      this._value = this._classList.join(' ');\r\n    }\r\n    return this._value;\r\n  }\r\n  set value(val: string) {\r\n    this._setValue(val, true);\r\n  }\r\n  get length(): number {\r\n    return this._classList.length;\r\n  }\r\n  /** @internal */\r\n  _setValue(val: string, dispatch: boolean) {\r\n    this._classList = val.split(/\\s+/).filter((value) => !!value);\r\n    this._valueChanged = true;\r\n    if (dispatch) {\r\n      this._notify();\r\n    }\r\n  }\r\n  /** @internal */\r\n  _notify() {\r\n    const el = RClassList._elementMap.get(this);\r\n    el.dispatchEvent(this._changeEvent);\r\n  }\r\n  add(...args: string[]) {\r\n    let changed = false;\r\n    for (const arg of args) {\r\n      if (arg && typeof arg === 'string') {\r\n        const classes = arg.split(/\\s+/);\r\n        classes.forEach((cls) => {\r\n          if (this._classList.indexOf(cls) < 0) {\r\n            this._classList.push(cls);\r\n            changed = true;\r\n          }\r\n        });\r\n      }\r\n    }\r\n    if (changed) {\r\n      this._valueChanged = true;\r\n      this._notify();\r\n    }\r\n  }\r\n  remove(...args: string[]) {\r\n    let changed = false;\r\n    for (const arg of args) {\r\n      if (arg && typeof arg === 'string') {\r\n        const classes = arg.split(/\\s+/);\r\n        classes.forEach((cls) => {\r\n          const index = this._classList.indexOf(cls);\r\n          if (index >= 0) {\r\n            this._classList.splice(index, 1);\r\n            changed = true;\r\n          }\r\n        });\r\n      }\r\n    }\r\n    if (changed) {\r\n      this._valueChanged = true;\r\n      this._notify();\r\n    }\r\n  }\r\n  toggle(className: string): boolean {\r\n    this._valueChanged = true;\r\n    const index = this._classList.indexOf(className);\r\n    if (index >= 0) {\r\n      this._classList.splice(index, 1);\r\n      this._notify();\r\n      return false;\r\n    } else {\r\n      this._classList.push(className);\r\n      this._notify();\r\n      return true;\r\n    }\r\n  }\r\n  contains(className: string): boolean {\r\n    return this._classList.indexOf(className) >= 0;\r\n  }\r\n  replace(oldClassName: string, newClassName: string) {\r\n    if (newClassName !== oldClassName) {\r\n      if (!oldClassName || oldClassName.indexOf(' ') >= 0) {\r\n        throw new Error('Failed to replace class: old class name is invalid');\r\n      }\r\n      oldClassName = oldClassName.trim();\r\n      if (oldClassName === '') {\r\n        throw new Error('Failed to replace class: old class name is empty');\r\n      }\r\n      const index = this._classList.indexOf(oldClassName);\r\n      if (index < 0) {\r\n        throw new Error('Failed to replace class: old class name not exists');\r\n      }\r\n      newClassName = newClassName || '';\r\n      newClassName = newClassName.trim();\r\n      const newClassNames = newClassName.split(/\\s+/).filter((val) => !!val);\r\n      this._classList.splice(index, 1, ...newClassNames);\r\n\r\n      this._notify();\r\n    }\r\n  }\r\n}\r\n\r\nexport interface RAttr {\r\n  name: string;\r\n  value: string;\r\n}\r\n\r\nexport class RElement extends RNode {\r\n  /** @internal */\r\n  protected _tagname: string;\r\n  /** @internal */\r\n  protected _attributes: {[name: string]: string};\r\n  /** @internal */\r\n  protected _classList: RClassList;\r\n  /** @internal */\r\n  protected _attrChangeEvent: RAttributeChangeEvent;\r\n  constructor(uiscene: GUI) {\r\n    super(uiscene);\r\n    this._tagname = null;\r\n    this._attributes = {};\r\n    this._classList = new RClassList(this);\r\n    this._attrChangeEvent = new RAttributeChangeEvent('', false);\r\n    this.addDefaultEventListener(RAttributeChangeEvent.NAME, (e: REvent) => {\r\n      const data = e as RAttributeChangeEvent;\r\n      if (data.name === 'class') {\r\n        this._uiscene._markStyleRefreshForElement(this);\r\n      }\r\n    });\r\n  }\r\n  get children(): RNodeList {\r\n    return this._childrenElements;\r\n  }\r\n  get childElementCount(): number {\r\n    return this._childrenElements.length;\r\n  }\r\n  get nodeType(): number {\r\n    return RNode.ELEMENT_NODE;\r\n  }\r\n  get localName(): string {\r\n    return this._tagname;\r\n  }\r\n  get tagName(): string {\r\n    return this._tagname;\r\n  }\r\n  get id(): string {\r\n    return this._attributes.id || '';\r\n  }\r\n  set id(id: string) {\r\n    this._attributes.id = id || '';\r\n  }\r\n  get classList(): RClassList {\r\n    return this._classList;\r\n  }\r\n  get className(): string {\r\n    return this._classList.value;\r\n  }\r\n  get attributes(): RAttr[] {\r\n    const result: RAttr[] = [];\r\n    for (const name in this._attributes) {\r\n      result.push({name: name, value: this._attributes[name]});\r\n    }\r\n    return result;\r\n  }\r\n  get firstElementChild(): RElement {\r\n    return this._getFirstChild(true) as RElement;\r\n  }\r\n  get lastElementChild(): RElement {\r\n    return this._getLastChild(true) as RElement;\r\n  }\r\n  get nextElementSibling(): RElement {\r\n    return this._getNextSibling(true) as RElement;\r\n  }\r\n  get previousElementSibling(): RElement {\r\n    return this._getPreviousSibling(true) as RElement;\r\n  }\r\n  getAttribute(k: string): string {\r\n    if (k) {\r\n      k = k.toLowerCase();\r\n      return k === 'class'\r\n        ? this._classList.value\r\n        : (this._attributes && this._attributes[k]) || null;\r\n    }\r\n    return null;\r\n  }\r\n  setAttribute(k: string, v?: string) {\r\n    if (k) {\r\n      v = v || null;\r\n      k = k.toLowerCase();\r\n      if (this._attributes[k] !== v) {\r\n        this._attributes[k] = v;\r\n        if (k === 'class') {\r\n          this._classList._setValue(v || '', false);\r\n        } else if (k === 'style') {\r\n          this._uiscene._markStyleRefreshForElement(this);\r\n        }\r\n        this._attrChangeEvent.name = k;\r\n        this._attrChangeEvent.removed = false;\r\n        this.dispatchEvent(this._attrChangeEvent);\r\n      }\r\n    }\r\n  }\r\n  removeAttribute(k: string) {\r\n    if (k) {\r\n      k = k.toLowerCase();\r\n      if (this._attributes[k] !== undefined) {\r\n        delete this._attributes[k];\r\n        if (k === 'style') {\r\n          this._uiscene._markStyleRefreshForElement(this);\r\n        }\r\n        this._attrChangeEvent.name = k;\r\n        this._attrChangeEvent.removed = true;\r\n        this.dispatchEvent(this._attrChangeEvent);\r\n      }\r\n    }\r\n  }\r\n  hasAttribute(k: string): boolean {\r\n    return k ? this._attributes[k.toLowerCase()] !== undefined : false;\r\n  }\r\n  hasAttributes(): boolean {\r\n    return Object.getOwnPropertyNames(this._attributes).length !== 0;\r\n  }\r\n  insertAdjacentElement(position: string, element: RElement) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n    if (position === 'beforebegin') {\r\n      this.before(element);\r\n      return element;\r\n    } else if (position === 'afterend') {\r\n      this.after(element);\r\n      return element;\r\n    } else if (position === 'afterbegin') {\r\n      this.prepend(element);\r\n      return element;\r\n    } else if (position === 'beforeend') {\r\n      this.append(element);\r\n      return element;\r\n    }\r\n    return null;\r\n  }\r\n  insertAdjacentText(position: string, text: string) {\r\n    if (!text) {\r\n      return null;\r\n    }\r\n    if (position === 'beforebegin') {\r\n      this.before(text);\r\n      return text;\r\n    } else if (position === 'afterend') {\r\n      this.after(text);\r\n      return text;\r\n    } else if (position === 'afterbegin') {\r\n      this.prepend(text);\r\n      return text;\r\n    } else if (position === 'beforeend') {\r\n      this.append(text);\r\n      return text;\r\n    }\r\n    return null;\r\n  }\r\n  matches(selectorString: string): boolean {\r\n    return this.ownerDocument.querySelectorAll(selectorString).indexOf(this) >= 0;\r\n  }\r\n  cloneNode(deep: boolean): RNode {\r\n    const clone = this._uiscene.createElement(this.tagName);\r\n    clone.classList._setValue(this.classList.value, false);\r\n    clone._attributes = Object.assign({}, this._attributes);\r\n    if (deep) {\r\n      for (let child = this.firstChild; child; child = child.nextSibling) {\r\n        clone.appendChild(child.cloneNode(deep));\r\n      }\r\n    }\r\n    return clone;\r\n  }\r\n  replaceWith(...nodes: (RNode | string)[]): void {\r\n    this.before(...nodes);\r\n    this.remove();\r\n  }\r\n  /** @internal */\r\n  _updateStyle(val: string) {\r\n    super._updateStyle(val);\r\n    this._rawSetStyleAttribute(val);\r\n  }\r\n  /** @internal */\r\n  _applyInlineStyles() {\r\n    this.style.applyStyles(this.getAttribute('style') || '', true);\r\n  }\r\n  /** @internal */\r\n  protected _getNumberAttribute(name: string, defaultValue: number): number {\r\n    const val = this.getAttribute(name);\r\n    const num = val === null ? defaultValue : Number(val);\r\n    return Number.isNaN(num) ? defaultValue : num;\r\n  }\r\n  /** @internal */\r\n  protected _setNumberAttribute(name: string, val: number) {\r\n    this.setAttribute(name, String(val));\r\n  }\r\n  /** @internal */\r\n  protected _getStringAttribute(name: string, defaultValue: string): string {\r\n    const val = this.getAttribute(name);\r\n    return val ? String(val) : defaultValue;\r\n  }\r\n  /** @internal */\r\n  protected _setStringAttribute(name: string, val: string) {\r\n    this.setAttribute(name, String(val));\r\n  }\r\n  /** @internal */\r\n  _rawSetStyleAttribute(style: string) {\r\n    style = style || '';\r\n    if (this._attributes['style'] !== style) {\r\n      this._attributes['style'] = style;\r\n      this._attrChangeEvent.name = 'style';\r\n      this._attrChangeEvent.removed = false;\r\n      this.dispatchEvent(this._attrChangeEvent);\r\n    }\r\n  }\r\n  /** @internal */\r\n  _setTagName(name: string) {\r\n    this._tagname = name;\r\n  }\r\n  remove(): RNode {\r\n    this._remove();\r\n    return this;\r\n  }\r\n  before(...nodes: (RNode | string)[]): void {\r\n    this._before(...nodes);\r\n  }\r\n  after(...nodes: (RNode | string)[]): void {\r\n    this._after(...nodes);\r\n  }\r\n  append(...nodes: (RNode | string)[]): void {\r\n    this._append(...nodes);\r\n  }\r\n  prepend(...nodes: (RNode | string)[]): void {\r\n    this._prepend(...nodes);\r\n  }\r\n  querySelectorAll(selectors: string): RNodeList {\r\n    return new RStaticNodeList(this._uiscene._querySelectorAll(this, selectors, true, false));\r\n  }\r\n  querySelector<T extends RElement>(selectors: string): T {\r\n    return this._uiscene._querySelectorOne<T>(this, selectors, true, false);\r\n  }\r\n  getElementById(id: string): RElement {\r\n    for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\r\n      const el = this._uiscene._getElementById(child, id);\r\n      if (el) {\r\n        return el;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  getElementsByTagName(tagName: string): RNodeList {\r\n    const results: RElement[] = [];\r\n    for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\r\n      this._uiscene._getElementsByTagName(child, tagName, results);\r\n    }\r\n    return new RStaticNodeList(results);\r\n  }\r\n  getElementsByClassName(classnames: string): RNodeList {\r\n    const results: RElement[] = [];\r\n    classnames = classnames || '';\r\n    const classNameList = classnames.split(/\\s+/).filter((val) => !!val);\r\n    if (classNameList.length > 0) {\r\n      for (let child = this.firstElementChild; child; child = child.nextElementSibling) {\r\n        this._uiscene._getElementsByClassName(child, classNameList, results);\r\n      }\r\n    }\r\n    return new RStaticNodeList(results);\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;MAUa,UAAU,CAAA;AAEb,IAAA,OAAO,WAAW,GAAkC,IAAI,OAAO,EAAE,CAAC;AAElE,IAAA,UAAU,CAAW;AAErB,IAAA,MAAM,CAAS;AAEf,IAAA,aAAa,CAAU;AAEvB,IAAA,YAAY,CAAwB;AAC5C,IAAA,WAAA,CAAY,EAAY,EAAA;AACtB,QAAA,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,QAAA,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;AACjB,QAAA,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC3B,IAAI,CAAC,YAAY,GAAG,IAAI,qBAAqB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC9D,QAAA,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,EAAE;AAC5B,YAAA,GAAG,EAAE,UAAU,MAAM,EAAE,IAAI,EAAA;gBACzB,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBAClD,OAAO,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;AAC1C,iBAAA;AAAM,qBAAA;AACL,oBAAA,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;AACrB,iBAAA;aACF;AACF,SAAA,CAAC,CAAC;QACH,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AACtC,QAAA,OAAO,KAAK,CAAC;KACd;AACD,IAAA,IAAI,KAAK,GAAA;QACP,IAAI,IAAI,CAAC,aAAa,EAAE;AACtB,YAAA,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;YAC3B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACzC,SAAA;QACD,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;IACD,IAAI,KAAK,CAAC,GAAW,EAAA;AACnB,QAAA,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;KAC3B;AACD,IAAA,IAAI,MAAM,GAAA;AACR,QAAA,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;KAC/B;IAED,SAAS,CAAC,GAAW,EAAE,QAAiB,EAAA;QACtC,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC;AAC9D,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC1B,QAAA,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,OAAO,EAAE,CAAC;AAChB,SAAA;KACF;IAED,OAAO,GAAA;QACL,MAAM,EAAE,GAAG,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC5C,QAAA,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;KACrC;IACD,GAAG,CAAC,GAAG,IAAc,EAAA;QACnB,IAAI,OAAO,GAAG,KAAK,CAAC;AACpB,QAAA,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;AACtB,YAAA,IAAI,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gBAClC,MAAM,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACjC,gBAAA,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,KAAI;oBACtB,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;AACpC,wBAAA,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAC1B,OAAO,GAAG,IAAI,CAAC;AAChB,qBAAA;AACH,iBAAC,CAAC,CAAC;AACJ,aAAA;AACF,SAAA;AACD,QAAA,IAAI,OAAO,EAAE;AACX,YAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;YAC1B,IAAI,CAAC,OAAO,EAAE,CAAC;AAChB,SAAA;KACF;IACD,MAAM,CAAC,GAAG,IAAc,EAAA;QACtB,IAAI,OAAO,GAAG,KAAK,CAAC;AACpB,QAAA,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;AACtB,YAAA,IAAI,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gBAClC,MAAM,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACjC,gBAAA,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,KAAI;oBACtB,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;oBAC3C,IAAI,KAAK,IAAI,CAAC,EAAE;wBACd,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;wBACjC,OAAO,GAAG,IAAI,CAAC;AAChB,qBAAA;AACH,iBAAC,CAAC,CAAC;AACJ,aAAA;AACF,SAAA;AACD,QAAA,IAAI,OAAO,EAAE;AACX,YAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;YAC1B,IAAI,CAAC,OAAO,EAAE,CAAC;AAChB,SAAA;KACF;AACD,IAAA,MAAM,CAAC,SAAiB,EAAA;AACtB,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC1B,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACjD,IAAI,KAAK,IAAI,CAAC,EAAE;YACd,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACjC,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,YAAA,OAAO,KAAK,CAAC;AACd,SAAA;AAAM,aAAA;AACL,YAAA,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YAChC,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;KACF;AACD,IAAA,QAAQ,CAAC,SAAiB,EAAA;QACxB,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;KAChD;IACD,OAAO,CAAC,YAAoB,EAAE,YAAoB,EAAA;QAChD,IAAI,YAAY,KAAK,YAAY,EAAE;YACjC,IAAI,CAAC,YAAY,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;AACnD,gBAAA,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;AACvE,aAAA;AACD,YAAA,YAAY,GAAG,YAAY,CAAC,IAAI,EAAE,CAAC;YACnC,IAAI,YAAY,KAAK,EAAE,EAAE;AACvB,gBAAA,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;AACrE,aAAA;YACD,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;YACpD,IAAI,KAAK,GAAG,CAAC,EAAE;AACb,gBAAA,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;AACvE,aAAA;AACD,YAAA,YAAY,GAAG,YAAY,IAAI,EAAE,CAAC;AAClC,YAAA,YAAY,GAAG,YAAY,CAAC,IAAI,EAAE,CAAC;YACnC,MAAM,aAAa,GAAG,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AACvE,YAAA,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,GAAG,aAAa,CAAC,CAAC;YAEnD,IAAI,CAAC,OAAO,EAAE,CAAC;AAChB,SAAA;KACF;;AAQG,MAAO,QAAS,SAAQ,KAAK,CAAA;AAEvB,IAAA,QAAQ,CAAS;AAEjB,IAAA,WAAW,CAA2B;AAEtC,IAAA,UAAU,CAAa;AAEvB,IAAA,gBAAgB,CAAwB;AAClD,IAAA,WAAA,CAAY,OAAY,EAAA;QACtB,KAAK,CAAC,OAAO,CAAC,CAAC;AACf,QAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACrB,QAAA,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,UAAU,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,gBAAgB,GAAG,IAAI,qBAAqB,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;QAC7D,IAAI,CAAC,uBAAuB,CAAC,qBAAqB,CAAC,IAAI,EAAE,CAAC,CAAS,KAAI;YACrE,MAAM,IAAI,GAAG,CAA0B,CAAC;AACxC,YAAA,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;AACzB,gBAAA,IAAI,CAAC,QAAQ,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC;AACjD,aAAA;AACH,SAAC,CAAC,CAAC;KACJ;AACD,IAAA,IAAI,QAAQ,GAAA;QACV,OAAO,IAAI,CAAC,iBAAiB,CAAC;KAC/B;AACD,IAAA,IAAI,iBAAiB,GAAA;AACnB,QAAA,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;KACtC;AACD,IAAA,IAAI,QAAQ,GAAA;QACV,OAAO,KAAK,CAAC,YAAY,CAAC;KAC3B;AACD,IAAA,IAAI,SAAS,GAAA;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;AACD,IAAA,IAAI,OAAO,GAAA;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;AACD,IAAA,IAAI,EAAE,GAAA;AACJ,QAAA,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE,CAAC;KAClC;IACD,IAAI,EAAE,CAAC,EAAU,EAAA;QACf,IAAI,CAAC,WAAW,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;KAChC;AACD,IAAA,IAAI,SAAS,GAAA;QACX,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;AACD,IAAA,IAAI,SAAS,GAAA;AACX,QAAA,OAAO,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;KAC9B;AACD,IAAA,IAAI,UAAU,GAAA;QACZ,MAAM,MAAM,GAAY,EAAE,CAAC;AAC3B,QAAA,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE;AACnC,YAAA,MAAM,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC,CAAC,CAAC;AAC1D,SAAA;AACD,QAAA,OAAO,MAAM,CAAC;KACf;AACD,IAAA,IAAI,iBAAiB,GAAA;AACnB,QAAA,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAa,CAAC;KAC9C;AACD,IAAA,IAAI,gBAAgB,GAAA;AAClB,QAAA,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAa,CAAC;KAC7C;AACD,IAAA,IAAI,kBAAkB,GAAA;AACpB,QAAA,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAa,CAAC;KAC/C;AACD,IAAA,IAAI,sBAAsB,GAAA;AACxB,QAAA,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAa,CAAC;KACnD;AACD,IAAA,YAAY,CAAC,CAAS,EAAA;AACpB,QAAA,IAAI,CAAC,EAAE;AACL,YAAA,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,OAAO;AAClB,kBAAE,IAAI,CAAC,UAAU,CAAC,KAAK;AACvB,kBAAE,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC;AACvD,SAAA;AACD,QAAA,OAAO,IAAI,CAAC;KACb;IACD,YAAY,CAAC,CAAS,EAAE,CAAU,EAAA;AAChC,QAAA,IAAI,CAAC,EAAE;AACL,YAAA,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC;AACd,YAAA,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;YACpB,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;AAC7B,gBAAA,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;gBACxB,IAAI,CAAC,KAAK,OAAO,EAAE;oBACjB,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;AAC3C,iBAAA;qBAAM,IAAI,CAAC,KAAK,OAAO,EAAE;AACxB,oBAAA,IAAI,CAAC,QAAQ,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC;AACjD,iBAAA;AACD,gBAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,CAAC,CAAC;AAC/B,gBAAA,IAAI,CAAC,gBAAgB,CAAC,OAAO,GAAG,KAAK,CAAC;AACtC,gBAAA,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAC3C,aAAA;AACF,SAAA;KACF;AACD,IAAA,eAAe,CAAC,CAAS,EAAA;AACvB,QAAA,IAAI,CAAC,EAAE;AACL,YAAA,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;YACpB,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;AACrC,gBAAA,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAC3B,IAAI,CAAC,KAAK,OAAO,EAAE;AACjB,oBAAA,IAAI,CAAC,QAAQ,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC;AACjD,iBAAA;AACD,gBAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,CAAC,CAAC;AAC/B,gBAAA,IAAI,CAAC,gBAAgB,CAAC,OAAO,GAAG,IAAI,CAAC;AACrC,gBAAA,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAC3C,aAAA;AACF,SAAA;KACF;AACD,IAAA,YAAY,CAAC,CAAS,EAAA;AACpB,QAAA,OAAO,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,KAAK,SAAS,GAAG,KAAK,CAAC;KACpE;IACD,aAAa,GAAA;AACX,QAAA,OAAO,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;KAClE;IACD,qBAAqB,CAAC,QAAgB,EAAE,OAAiB,EAAA;QACvD,IAAI,CAAC,OAAO,EAAE;AACZ,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;QACD,IAAI,QAAQ,KAAK,aAAa,EAAE;AAC9B,YAAA,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACrB,YAAA,OAAO,OAAO,CAAC;AAChB,SAAA;aAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;AAClC,YAAA,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AACpB,YAAA,OAAO,OAAO,CAAC;AAChB,SAAA;aAAM,IAAI,QAAQ,KAAK,YAAY,EAAE;AACpC,YAAA,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AACtB,YAAA,OAAO,OAAO,CAAC;AAChB,SAAA;aAAM,IAAI,QAAQ,KAAK,WAAW,EAAE;AACnC,YAAA,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACrB,YAAA,OAAO,OAAO,CAAC;AAChB,SAAA;AACD,QAAA,OAAO,IAAI,CAAC;KACb;IACD,kBAAkB,CAAC,QAAgB,EAAE,IAAY,EAAA;QAC/C,IAAI,CAAC,IAAI,EAAE;AACT,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;QACD,IAAI,QAAQ,KAAK,aAAa,EAAE;AAC9B,YAAA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAClB,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;aAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;AAClC,YAAA,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACjB,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;aAAM,IAAI,QAAQ,KAAK,YAAY,EAAE;AACpC,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AACnB,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;aAAM,IAAI,QAAQ,KAAK,WAAW,EAAE;AACnC,YAAA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAClB,YAAA,OAAO,IAAI,CAAC;AACb,SAAA;AACD,QAAA,OAAO,IAAI,CAAC;KACb;AACD,IAAA,OAAO,CAAC,cAAsB,EAAA;AAC5B,QAAA,OAAO,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC/E;AACD,IAAA,SAAS,CAAC,IAAa,EAAA;AACrB,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACxD,QAAA,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;AACvD,QAAA,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AACxD,QAAA,IAAI,IAAI,EAAE;AACR,YAAA,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,WAAW,EAAE;gBAClE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;AAC1C,aAAA;AACF,SAAA;AACD,QAAA,OAAO,KAAK,CAAC;KACd;IACD,WAAW,CAAC,GAAG,KAAyB,EAAA;AACtC,QAAA,IAAI,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,CAAC;QACtB,IAAI,CAAC,MAAM,EAAE,CAAC;KACf;AAED,IAAA,YAAY,CAAC,GAAW,EAAA;AACtB,QAAA,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;AACxB,QAAA,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;KACjC;IAED,kBAAkB,GAAA;AAChB,QAAA,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,CAAC;KAChE;IAES,mBAAmB,CAAC,IAAY,EAAE,YAAoB,EAAA;QAC9D,MAAM,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;AACpC,QAAA,MAAM,GAAG,GAAG,GAAG,KAAK,IAAI,GAAG,YAAY,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACtD,QAAA,OAAO,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,YAAY,GAAG,GAAG,CAAC;KAC/C;IAES,mBAAmB,CAAC,IAAY,EAAE,GAAW,EAAA;QACrD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;KACtC;IAES,mBAAmB,CAAC,IAAY,EAAE,YAAoB,EAAA;QAC9D,MAAM,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;AACpC,QAAA,OAAO,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,GAAG,YAAY,CAAC;KACzC;IAES,mBAAmB,CAAC,IAAY,EAAE,GAAW,EAAA;QACrD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;KACtC;AAED,IAAA,qBAAqB,CAAC,KAAa,EAAA;AACjC,QAAA,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QACpB,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,KAAK,KAAK,EAAE;AACvC,YAAA,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC;AAClC,YAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,OAAO,CAAC;AACrC,YAAA,IAAI,CAAC,gBAAgB,CAAC,OAAO,GAAG,KAAK,CAAC;AACtC,YAAA,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAC3C,SAAA;KACF;AAED,IAAA,WAAW,CAAC,IAAY,EAAA;AACtB,QAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;KACtB;IACD,MAAM,GAAA;QACJ,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,QAAA,OAAO,IAAI,CAAC;KACb;IACD,MAAM,CAAC,GAAG,KAAyB,EAAA;AACjC,QAAA,IAAI,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,CAAC;KACxB;IACD,KAAK,CAAC,GAAG,KAAyB,EAAA;AAChC,QAAA,IAAI,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,CAAC;KACvB;IACD,MAAM,CAAC,GAAG,KAAyB,EAAA;AACjC,QAAA,IAAI,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,CAAC;KACxB;IACD,OAAO,CAAC,GAAG,KAAyB,EAAA;AAClC,QAAA,IAAI,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC,CAAC;KACzB;AACD,IAAA,gBAAgB,CAAC,SAAiB,EAAA;AAChC,QAAA,OAAO,IAAI,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;KAC3F;AACD,IAAA,aAAa,CAAqB,SAAiB,EAAA;AACjD,QAAA,OAAO,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAI,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;KACzE;AACD,IAAA,cAAc,CAAC,EAAU,EAAA;AACvB,QAAA,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE;AAChF,YAAA,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AACpD,YAAA,IAAI,EAAE,EAAE;AACN,gBAAA,OAAO,EAAE,CAAC;AACX,aAAA;AACF,SAAA;AACD,QAAA,OAAO,IAAI,CAAC;KACb;AACD,IAAA,oBAAoB,CAAC,OAAe,EAAA;QAClC,MAAM,OAAO,GAAe,EAAE,CAAC;AAC/B,QAAA,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE;YAChF,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;AAC9D,SAAA;AACD,QAAA,OAAO,IAAI,eAAe,CAAC,OAAO,CAAC,CAAC;KACrC;AACD,IAAA,sBAAsB,CAAC,UAAkB,EAAA;QACvC,MAAM,OAAO,GAAe,EAAE,CAAC;AAC/B,QAAA,UAAU,GAAG,UAAU,IAAI,EAAE,CAAC;QAC9B,MAAM,aAAa,GAAG,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AACrE,QAAA,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;AAC5B,YAAA,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE;gBAChF,IAAI,CAAC,QAAQ,CAAC,uBAAuB,CAAC,KAAK,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;AACtE,aAAA;AACF,SAAA;AACD,QAAA,OAAO,IAAI,eAAe,CAAC,OAAO,CAAC,CAAC;KACrC;AACF;;;;"}