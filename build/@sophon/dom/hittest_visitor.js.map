{"version":3,"file":"hittest_visitor.js","sources":["../../../libs/dom/src/hittest_visitor.ts"],"sourcesContent":["import type {RNode} from './node';\n\nexport class GUIHitTestVisitor {\n  /** @internal */\n  private _x: number;\n  /** @internal */\n  private _y: number;\n  /** @internal */\n  private _hits: {element: RNode; x: number; y: number}[];\n  constructor(x: number, y: number) {\n    this._x = x;\n    this._y = y;\n    this._hits = [];\n  }\n  getHits(): {element: RNode; x: number; y: number}[] {\n    return this._hits;\n  }\n  beginTraverseNode() {}\n  endTraverseNode() {}\n  visitNode(w: RNode) {\n    if (w.isDocument()) {\n      this._hits.push({\n        element: w,\n        x: this._x,\n        y: this._y,\n      });\n    } else if (w._isVisible() && !w._isText()) {\n      const v = w.toAbsolute({x: 0, y: 0});\n      const x = this._x - v.x;\n      const y = this._y - v.y;\n      const rc = w.getClippedRect();\n      const cx1 = rc ? rc.x : 0;\n      const cy1 = rc ? rc.y : 0;\n      const cx2 = rc ? rc.x + rc.width : w.getRect().width;\n      const cy2 = rc ? rc.y + rc.height : w.getRect().height;\n      if (x >= cx1 && x < cx2 && y >= cy1 && y < cy2) {\n        this._hits.push({\n          element: w,\n          x: x,\n          y: y,\n        });\n      }\n    }\n  }\n}\n"],"names":[],"mappings":";MAEa,iBAAiB,CAAA;AAEpB,IAAA,EAAE,CAAS;AAEX,IAAA,EAAE,CAAS;AAEX,IAAA,KAAK,CAA2C;IACxD,WAAY,CAAA,CAAS,EAAE,CAAS,EAAA;AAC9B,QAAA,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;AACZ,QAAA,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;AACZ,QAAA,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;KACjB;IACD,OAAO,GAAA;QACL,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;AACD,IAAA,iBAAiB,MAAK;AACtB,IAAA,eAAe,MAAK;AACpB,IAAA,SAAS,CAAC,CAAQ,EAAA;AAChB,QAAA,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE;AAClB,YAAA,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;AACd,gBAAA,OAAO,EAAE,CAAC;gBACV,CAAC,EAAE,IAAI,CAAC,EAAE;gBACV,CAAC,EAAE,IAAI,CAAC,EAAE;AACX,aAAA,CAAC,CAAC;AACJ,SAAA;aAAM,IAAI,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE;AACzC,YAAA,MAAM,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,EAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAC,CAAC,CAAC;YACrC,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;AACxB,YAAA,MAAM,EAAE,GAAG,CAAC,CAAC,cAAc,EAAE,CAAC;AAC9B,YAAA,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;AAC1B,YAAA,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;YAC1B,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,KAAK,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC;YACrD,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC;AACvD,YAAA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,EAAE;AAC9C,gBAAA,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;AACd,oBAAA,OAAO,EAAE,CAAC;AACV,oBAAA,CAAC,EAAE,CAAC;AACJ,oBAAA,CAAC,EAAE,CAAC;AACL,iBAAA,CAAC,CAAC;AACJ,aAAA;AACF,SAAA;KACF;AACF;;;;"}