{"version":3,"file":"hittest_visitor.js","sources":["../../../libs/dom/src/hittest_visitor.ts"],"sourcesContent":["import type {RNode} from './node';\r\n\r\nexport class GUIHitTestVisitor {\r\n  /** @internal */\r\n  private _x: number;\r\n  /** @internal */\r\n  private _y: number;\r\n  /** @internal */\r\n  private _hits: {element: RNode; x: number; y: number}[];\r\n  constructor(x: number, y: number) {\r\n    this._x = x;\r\n    this._y = y;\r\n    this._hits = [];\r\n  }\r\n  getHits(): {element: RNode; x: number; y: number}[] {\r\n    return this._hits;\r\n  }\r\n  beginTraverseNode() {}\r\n  endTraverseNode() {}\r\n  visitNode(w: RNode) {\r\n    if (w.isDocument()) {\r\n      this._hits.push({\r\n        element: w,\r\n        x: this._x,\r\n        y: this._y,\r\n      });\r\n    } else if (w._isVisible() && !w._isText()) {\r\n      const v = w.toAbsolute({x: 0, y: 0});\r\n      const x = this._x - v.x;\r\n      const y = this._y - v.y;\r\n      const rc = w.getClippedRect();\r\n      const cx1 = rc ? rc.x : 0;\r\n      const cy1 = rc ? rc.y : 0;\r\n      const cx2 = rc ? rc.x + rc.width : w.getRect().width;\r\n      const cy2 = rc ? rc.y + rc.height : w.getRect().height;\r\n      if (x >= cx1 && x < cx2 && y >= cy1 && y < cy2) {\r\n        this._hits.push({\r\n          element: w,\r\n          x: x,\r\n          y: y,\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":";MAEa,iBAAiB,CAAA;AAEpB,IAAA,EAAE,CAAS;AAEX,IAAA,EAAE,CAAS;AAEX,IAAA,KAAK,CAA2C;IACxD,WAAY,CAAA,CAAS,EAAE,CAAS,EAAA;AAC9B,QAAA,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;AACZ,QAAA,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;AACZ,QAAA,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;KACjB;IACD,OAAO,GAAA;QACL,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;AACD,IAAA,iBAAiB,MAAK;AACtB,IAAA,eAAe,MAAK;AACpB,IAAA,SAAS,CAAC,CAAQ,EAAA;AAChB,QAAA,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE;AAClB,YAAA,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;AACd,gBAAA,OAAO,EAAE,CAAC;gBACV,CAAC,EAAE,IAAI,CAAC,EAAE;gBACV,CAAC,EAAE,IAAI,CAAC,EAAE;AACX,aAAA,CAAC,CAAC;AACJ,SAAA;aAAM,IAAI,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE;AACzC,YAAA,MAAM,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,EAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAC,CAAC,CAAC;YACrC,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;AACxB,YAAA,MAAM,EAAE,GAAG,CAAC,CAAC,cAAc,EAAE,CAAC;AAC9B,YAAA,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;AAC1B,YAAA,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;YAC1B,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,KAAK,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC;YACrD,MAAM,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC;AACvD,YAAA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,EAAE;AAC9C,gBAAA,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;AACd,oBAAA,OAAO,EAAE,CAAC;AACV,oBAAA,CAAC,EAAE,CAAC;AACJ,oBAAA,CAAC,EAAE,CAAC;AACL,iBAAA,CAAC,CAAC;AACJ,aAAA;AACF,SAAA;KACF;AACF;;;;"}