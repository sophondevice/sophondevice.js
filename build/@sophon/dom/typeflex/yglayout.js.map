{"version":3,"file":"yglayout.js","sources":["../../../../libs/dom/src/typeflex/yglayout.ts"],"sourcesContent":["import {YGDirection} from './enums';\r\nimport {YGFloatOptional} from './ygfloatoptional';\r\nimport {YGCachedMeasurement} from './internal';\r\nimport {YGFloatArrayEqual} from './utils';\r\nimport {YGFloatIsUndefined} from './yoga';\r\n\r\nconst kYGDefaultDimensionValues: () => [number, number] = function() {\r\n  return [undefined, undefined];\r\n}\r\nconst YG_MAX_CACHED_RESULT_COUNT = 16;\r\n\r\nfunction buildCache(c: number): Array<YGCachedMeasurement> {\r\n  const ret: Array<YGCachedMeasurement> = [];\r\n  for (let i = 0; i < c; i++) {\r\n    ret.push(new YGCachedMeasurement());\r\n  }\r\n  return ret;\r\n}\r\n\r\nclass YGLayout {\r\n  public position: [number, number, number, number];\r\n  public dimensions: [number, number];\r\n  public margin: [number, number, number, number, number, number];\r\n  public border: [number, number, number, number, number, number];\r\n  public padding: [number, number, number, number, number, number];\r\n  public direction: YGDirection;\r\n\r\n  public computedFlexBasisGeneration: number;\r\n  public computedFlexBasis: YGFloatOptional;\r\n  public hadOverflow: boolean;\r\n\r\n  public generationCount: number;\r\n  public lastOwnerDirection: YGDirection;\r\n\r\n  public nextCachedMeasurementsIndex: number;\r\n  public cachedMeasurements: Array<YGCachedMeasurement>;\r\n  public measuredDimensions: Array<number>;\r\n\r\n  public cachedLayout: YGCachedMeasurement;\r\n  public didUseLegacyFlag: boolean;\r\n  public doesLegacyStretchFlagAffectsLayout: boolean;\r\n\r\n  constructor() {\r\n    this.dimensions = kYGDefaultDimensionValues();\r\n    this.direction = YGDirection.Inherit;\r\n    this.computedFlexBasisGeneration = 0;\r\n    this.computedFlexBasis = new YGFloatOptional();\r\n    this.hadOverflow = false;\r\n    this.generationCount = 0;\r\n    this.lastOwnerDirection = YGDirection.RTL;\r\n    this.nextCachedMeasurementsIndex = 0;\r\n    this.measuredDimensions = kYGDefaultDimensionValues();\r\n    this.cachedLayout = new YGCachedMeasurement();\r\n    this.didUseLegacyFlag = false;\r\n    this.doesLegacyStretchFlagAffectsLayout = false;\r\n    this.position = [undefined, undefined, undefined, undefined];\r\n    this.margin = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.border = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.padding = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.cachedMeasurements = buildCache(YG_MAX_CACHED_RESULT_COUNT);\r\n  }\r\n\r\n  equal(layout: YGLayout): boolean {\r\n    let isEqual: boolean =\r\n      YGFloatArrayEqual(this.position, layout.position) &&\r\n      YGFloatArrayEqual(this.dimensions, layout.dimensions) &&\r\n      YGFloatArrayEqual(this.margin, layout.margin) &&\r\n      YGFloatArrayEqual(this.border, layout.border) &&\r\n      YGFloatArrayEqual(this.padding, layout.padding) &&\r\n      this.direction == layout.direction &&\r\n      this.hadOverflow == layout.hadOverflow &&\r\n      this.lastOwnerDirection == layout.lastOwnerDirection &&\r\n      this.nextCachedMeasurementsIndex == layout.nextCachedMeasurementsIndex &&\r\n      this.cachedLayout == layout.cachedLayout &&\r\n      this.computedFlexBasis == layout.computedFlexBasis;\r\n\r\n    for (let i = 0; i < YG_MAX_CACHED_RESULT_COUNT && isEqual; ++i) {\r\n      isEqual = isEqual && this.cachedMeasurements[i] == layout.cachedMeasurements[i];\r\n    }\r\n\r\n    if (\r\n      !YGFloatIsUndefined(this.measuredDimensions[0]) ||\r\n      !YGFloatIsUndefined(layout.measuredDimensions[0])\r\n    ) {\r\n      isEqual = isEqual && this.measuredDimensions[0] == layout.measuredDimensions[0];\r\n    }\r\n\r\n    if (\r\n      !YGFloatIsUndefined(this.measuredDimensions[1]) ||\r\n      !YGFloatIsUndefined(layout.measuredDimensions[1])\r\n    ) {\r\n      isEqual = isEqual && this.measuredDimensions[1] == layout.measuredDimensions[1];\r\n    }\r\n\r\n    return isEqual;\r\n  }\r\n\r\n  diff(layout: YGLayout): boolean {\r\n    return !this.equal(layout);\r\n  }\r\n\r\n  clean(): void {\r\n    this.dimensions = kYGDefaultDimensionValues();\r\n    this.direction = YGDirection.Inherit;\r\n    this.computedFlexBasisGeneration = 0;\r\n    this.computedFlexBasis = new YGFloatOptional();\r\n    this.hadOverflow = false;\r\n    this.generationCount = 0;\r\n    this.lastOwnerDirection = YGDirection.RTL;\r\n    this.nextCachedMeasurementsIndex = 0;\r\n    this.measuredDimensions = kYGDefaultDimensionValues();\r\n    this.cachedLayout = new YGCachedMeasurement();\r\n    this.didUseLegacyFlag = false;\r\n    this.doesLegacyStretchFlagAffectsLayout = false;\r\n    this.position = [undefined, undefined, undefined, undefined];\r\n    this.margin = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.border = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.padding = [undefined, undefined, undefined, undefined, undefined, undefined];\r\n    this.cachedMeasurements = buildCache(YG_MAX_CACHED_RESULT_COUNT);\r\n  }\r\n\r\n  clone(): YGLayout {\r\n    const newLayout = new YGLayout();\r\n    newLayout.dimensions = [this.dimensions[0], this.dimensions[1]];\r\n    newLayout.direction = this.direction;\r\n    newLayout.computedFlexBasisGeneration = this.computedFlexBasisGeneration;\r\n    newLayout.computedFlexBasis = this.computedFlexBasis.clone();\r\n    newLayout.hadOverflow = this.hadOverflow;\r\n    newLayout.generationCount = this.generationCount;\r\n    newLayout.lastOwnerDirection = this.lastOwnerDirection;\r\n    newLayout.nextCachedMeasurementsIndex = this.nextCachedMeasurementsIndex;\r\n    newLayout.measuredDimensions = [this.measuredDimensions[0], this.measuredDimensions[1]];\r\n    newLayout.cachedLayout = this.cachedLayout.clone();\r\n    newLayout.didUseLegacyFlag = this.didUseLegacyFlag;\r\n    newLayout.doesLegacyStretchFlagAffectsLayout = this.doesLegacyStretchFlagAffectsLayout;\r\n    newLayout.position = [this.position[0], this.position[1], this.position[2], this.position[3]];\r\n    newLayout.margin = [\r\n      this.margin[0],\r\n      this.margin[1],\r\n      this.margin[2],\r\n      this.margin[3],\r\n      this.margin[4],\r\n      this.margin[5],\r\n    ];\r\n    newLayout.border = [\r\n      this.border[0],\r\n      this.border[1],\r\n      this.border[2],\r\n      this.border[3],\r\n      this.border[4],\r\n      this.border[5],\r\n    ];\r\n    newLayout.padding = [\r\n      this.padding[0],\r\n      this.padding[1],\r\n      this.padding[2],\r\n      this.padding[3],\r\n      this.padding[4],\r\n      this.padding[5],\r\n    ];\r\n    newLayout.cachedMeasurements = buildCache(YG_MAX_CACHED_RESULT_COUNT);\r\n    return newLayout;\r\n  }\r\n}\r\n\r\nexport {YGLayout};\r\n"],"names":[],"mappings":"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"}