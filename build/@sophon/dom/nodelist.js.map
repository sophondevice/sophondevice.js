{"version":3,"file":"nodelist.js","sources":["../../../libs/dom/src/nodelist.ts"],"sourcesContent":["import {NodeType} from './values';\r\nimport type {RNode} from './node';\r\n\r\ninterface IndexIterator extends Iterator<[number, RNode]> {\r\n  lastIndex: number;\r\n}\r\n\r\ninterface IndexKeyIterator extends Iterator<number> {\r\n  lastIndex: number;\r\n}\r\n\r\ninterface IndexValueIterator extends Iterator<RNode> {\r\n  lastIndex: number;\r\n}\r\n\r\nclass ElementIndexer {\r\n  static readonly MODE_ALL = 0;\r\n  static readonly MODE_NON_INTERNAL = 1;\r\n  static readonly MODE_ELEMENT_NON_INTERNAL = 2;\r\n  protected _parent: RNode;\r\n  protected _currentIndex: number;\r\n  protected _currentNode: RNode;\r\n  protected _length: number;\r\n  protected _mode: number;\r\n  protected _domTag: number;\r\n  constructor(parent: RNode, mode: number) {\r\n    this._parent = parent;\r\n    this._currentIndex = -1;\r\n    this._currentNode = null;\r\n    this._length = -1;\r\n    this._mode = mode;\r\n    this._domTag = parent.gui.domTag;\r\n  }\r\n  get length(): number {\r\n    return this._getLength();\r\n  }\r\n  item(index: number): RNode {\r\n    return this._at(index);\r\n  }\r\n  entries(): Iterable<[number, RNode]> {\r\n    return this._getEntriesIterator();\r\n  }\r\n  keys(): Iterable<number> {\r\n    return this._getKeysIterator();\r\n  }\r\n  values(): Iterable<RNode> {\r\n    return this._getValuesIterator();\r\n  }\r\n  forEach(\r\n    callback: (currentValue: RNode, currentIndex?: number, listObj?: unknown) => void,\r\n    thisArg?: unknown,\r\n  ) {\r\n    for (const entry of this.entries()) {\r\n      callback && callback.call(thisArg, entry[1], entry[0], this);\r\n    }\r\n  }\r\n  indexOf(node: RNode): number {\r\n    for (let i = 0; i < this.length; i++) {\r\n      if (this.item(i) === node) {\r\n        return i;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n  private _at(index: number): RNode {\r\n    if (index < 0 || index >= this.length) {\r\n      return null;\r\n    }\r\n    if (this._currentIndex < 0 || this._currentIndex >= this.length) {\r\n      this._reset(index);\r\n    } else {\r\n      while (index < this._currentIndex) {\r\n        this._previous();\r\n      }\r\n      while (index > this._currentIndex) {\r\n        this._next();\r\n      }\r\n    }\r\n    return this._currentNode;\r\n  }\r\n  private _reset(index: number) {\r\n    this._length = -1;\r\n    this._currentIndex = 0;\r\n    switch (this._mode) {\r\n    case ElementIndexer.MODE_ALL:\r\n      this._currentNode = this._parent._getLayout().firstChild()?.element || null;\r\n      break;\r\n    case ElementIndexer.MODE_NON_INTERNAL:\r\n      this._currentNode = this._getFirstNonInternalNode();\r\n      break;\r\n    case ElementIndexer.MODE_ELEMENT_NON_INTERNAL:\r\n      this._currentNode = this._getFirstNonInternalElement();\r\n      break;\r\n    default:\r\n      break;\r\n    }\r\n    while (this._currentIndex < index && this._currentNode) {\r\n      this._next();\r\n    }\r\n  }\r\n  private _getFirstNonInternalNode(): RNode {\r\n    for (let child = this._parent._getLayout().firstChild(); child; child = child.nextSibling()) {\r\n      if (!child.element._isInternal()) {\r\n        return child.element;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  private _getFirstNonInternalElement(): RNode {\r\n    for (let child = this._parent._getLayout().firstChild(); child; child = child.nextSibling()) {\r\n      if (!child.element._isInternal() && child.element.nodeType === NodeType.ELEMENT_NODE) {\r\n        return child.element;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  private _getLengthAll(): number {\r\n    return this._parent._getLayout().getNumChildren();\r\n  }\r\n  private _getLengthNonInternalNode(): number {\r\n    let length = 0;\r\n    for (let child = this._parent._getLayout().firstChild(); child; child = child.nextSibling()) {\r\n      if (!child.element._isInternal()) {\r\n        length++;\r\n      }\r\n    }\r\n    return length;\r\n  }\r\n  private _getLengthNonInternalElement(): number {\r\n    let length = 0;\r\n    for (let child = this._parent._getLayout().firstChild(); child; child = child.nextSibling()) {\r\n      if (!child.element._isInternal() && child.element.nodeType === NodeType.ELEMENT_NODE) {\r\n        length++;\r\n      }\r\n    }\r\n    return length;\r\n  }\r\n  private _getLength(): number {\r\n    if (this._domTag !== this._parent.gui.domTag) {\r\n      this._domTag = this._parent.gui.domTag;\r\n      this._reset(this._currentIndex);\r\n    }\r\n    if (this._length < 0) {\r\n      switch (this._mode) {\r\n      case ElementIndexer.MODE_ALL:\r\n        this._length = this._getLengthAll();\r\n        break;\r\n      case ElementIndexer.MODE_NON_INTERNAL:\r\n        this._length = this._getLengthNonInternalNode();\r\n        break;\r\n      case ElementIndexer.MODE_ELEMENT_NON_INTERNAL:\r\n        this._length = this._getLengthNonInternalElement();\r\n        break;\r\n      }\r\n    }\r\n    return this._length;\r\n  }\r\n  private _getKeysIterator() {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexKeyIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<number> {\r\n            this.lastIndex++;\r\n            if (that._domTag !== that._parent.gui.domTag) {\r\n              that._domTag = that._parent.gui.domTag;\r\n              that._reset(this.lastIndex);\r\n            }\r\n            if (this.lastIndex >= that.length) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              return {\r\n                done: false,\r\n                value: this.lastIndex,\r\n              };\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  private _getEntriesIterator() {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<[number, RNode]> {\r\n            this.lastIndex++;\r\n            if (that._domTag !== that._parent.gui.domTag || that._currentIndex !== this.lastIndex) {\r\n              that._domTag = that._parent.gui.domTag;\r\n              that._reset(this.lastIndex);\r\n            }\r\n            if (!that._currentNode) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              const ret: IteratorResult<[number, RNode]> = {\r\n                done: false,\r\n                value: [that._currentIndex, that._currentNode],\r\n              };\r\n              that._next();\r\n              return ret;\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  private _getValuesIterator() {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexValueIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<RNode> {\r\n            this.lastIndex++;\r\n            if (that._domTag !== that._parent.gui.domTag || that._currentIndex !== this.lastIndex) {\r\n              that._domTag = that._parent.gui.domTag;\r\n              that._reset(this.lastIndex);\r\n            }\r\n            if (!that._currentNode) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              const ret: IteratorResult<RNode> = {\r\n                done: false,\r\n                value: that._currentNode,\r\n              };\r\n              that._next();\r\n              return ret;\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  private _next(): void {\r\n    if (this._currentNode) {\r\n      switch (this._mode) {\r\n      case ElementIndexer.MODE_ALL: {\r\n        this._currentNode = this._currentNode._getLayout().nextSibling()?.element || null;\r\n        break;\r\n      }\r\n      case ElementIndexer.MODE_NON_INTERNAL: {\r\n        do {\r\n          this._currentNode = this._currentNode._getLayout().nextSibling()?.element || null;\r\n        } while (this._currentNode?._isInternal());\r\n        break;\r\n      }\r\n      case ElementIndexer.MODE_ELEMENT_NON_INTERNAL: {\r\n        do {\r\n          this._currentNode = this._currentNode._getLayout().nextSibling()?.element || null;\r\n        } while (\r\n          this._currentNode &&\r\n            (this._currentNode._isInternal() ||\r\n              this._currentNode.nodeType !== NodeType.ELEMENT_NODE)\r\n        );\r\n        break;\r\n      }\r\n      }\r\n      this._currentIndex++;\r\n    }\r\n  }\r\n  private _previous(): void {\r\n    if (this._currentNode) {\r\n      switch (this._mode) {\r\n      case ElementIndexer.MODE_ALL: {\r\n        this._currentNode = this._currentNode._getLayout().previousSibling()?.element || null;\r\n        break;\r\n      }\r\n      case ElementIndexer.MODE_NON_INTERNAL: {\r\n        do {\r\n          this._currentNode = this._currentNode._getLayout().previousSibling()?.element || null;\r\n        } while (this._currentNode?._isInternal());\r\n        break;\r\n      }\r\n      case ElementIndexer.MODE_ELEMENT_NON_INTERNAL: {\r\n        do {\r\n          this._currentNode = this._currentNode._getLayout().previousSibling()?.element || null;\r\n        } while (\r\n          this._currentNode &&\r\n            (this._currentNode._isInternal() ||\r\n              this._currentNode.nodeType !== NodeType.ELEMENT_NODE)\r\n        );\r\n        break;\r\n      }\r\n      }\r\n      this._currentIndex--;\r\n    }\r\n  }\r\n}\r\n\r\nexport interface RNodeList {\r\n  length: number;\r\n  item(index: number): RNode;\r\n  entries(): Iterable<[number, RNode]>;\r\n  keys(): Iterable<number>;\r\n  values(): Iterable<RNode>;\r\n  indexOf(node: RNode): number;\r\n  forEach(\r\n    callback: (currentValue: RNode, currentIndex?: number, listObj?: RNodeList) => void,\r\n    thisArg?: unknown,\r\n  ): void;\r\n  [index: number]: RNode;\r\n}\r\n\r\n/** @internal */\r\nexport interface RStaticNodeList extends RNodeList {}\r\n\r\n/** @internal */\r\nexport class RStaticNodeList {\r\n  private _nodelist: RNode[];\r\n  constructor(nodelist: RNode[]) {\r\n    this._nodelist = nodelist;\r\n    return new Proxy(this, {\r\n      get: function (target, name) {\r\n        if (typeof name === 'string' && /^\\d+$/.test(name)) {\r\n          return target._nodelist[parseInt(name)] || undefined;\r\n        } else {\r\n          return target[name];\r\n        }\r\n      },\r\n      set: function () {\r\n        return false;\r\n      },\r\n    });\r\n  }\r\n  get length(): number {\r\n    return this._nodelist.length;\r\n  }\r\n  item(index: number): RNode {\r\n    return this._nodelist[index] || null;\r\n  }\r\n  entries(): Iterable<[number, RNode]> {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<[number, RNode]> {\r\n            this.lastIndex++;\r\n            if (this.lastIndex >= that.length) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              return {\r\n                done: false,\r\n                value: [this.lastIndex, that.item(this.lastIndex)],\r\n              };\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  keys(): Iterable<number> {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexKeyIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<number> {\r\n            this.lastIndex++;\r\n            if (this.lastIndex >= that.length) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              return {\r\n                done: false,\r\n                value: this.lastIndex,\r\n              };\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  values(): Iterable<RNode> {\r\n    const that = this;\r\n    return {\r\n      [Symbol.iterator](): IndexValueIterator {\r\n        return {\r\n          lastIndex: -1,\r\n          next(): IteratorResult<RNode> {\r\n            this.lastIndex++;\r\n            if (this.lastIndex >= that.length) {\r\n              this.lastIndex = -1;\r\n              return {\r\n                done: true,\r\n                value: null,\r\n              };\r\n            } else {\r\n              return {\r\n                done: false,\r\n                value: that.item(this.lastIndex),\r\n              };\r\n            }\r\n          },\r\n        };\r\n      },\r\n    };\r\n  }\r\n  indexOf(node: RNode): number {\r\n    return this._nodelist.indexOf(node);\r\n  }\r\n  forEach(\r\n    callback: (currentValue: RNode, currentIndex?: number, listObj?: RNodeList) => void,\r\n    thisArg?: unknown,\r\n  ): void {\r\n    const that = this;\r\n    if (callback) {\r\n      for (let i = 0; i < this._nodelist.length; i++) {\r\n        callback.call(thisArg, that._nodelist[i], i, that);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/** @internal */\r\nexport interface RLiveNodeList extends RNodeList {}\r\n\r\n/** @internal */\r\nexport class RLiveNodeList {\r\n  static readonly MODE_ALL = ElementIndexer.MODE_ALL;\r\n  static readonly MODE_NON_INTERNAL = ElementIndexer.MODE_NON_INTERNAL;\r\n  static readonly MODE_ELEMENT_NON_INTERNAL = ElementIndexer.MODE_ELEMENT_NON_INTERNAL;\r\n  private _indexer: ElementIndexer;\r\n  constructor(parent: RNode, mode: number) {\r\n    this._indexer = new ElementIndexer(parent, mode);\r\n    const proxy = new Proxy(this, {\r\n      get: function (target, name) {\r\n        if (typeof name === 'string' && /^\\d+$/.test(name)) {\r\n          return target._indexer.item(parseInt(name)) || undefined;\r\n        } else {\r\n          return target._indexer[name];\r\n        }\r\n      },\r\n      set: function (target, name, value) {\r\n        if (typeof name === 'string' && /^\\d+$/.test(name)) {\r\n          return false;\r\n        } else {\r\n          target._indexer[name] = value;\r\n          return true;\r\n        }\r\n      },\r\n    });\r\n    return proxy;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}