{"version":3,"file":"linkedlist.js","sources":["../../../libs/base/src/linkedlist.ts"],"sourcesContent":["export class ListIterator<T = unknown> {\n  /** @internal */\n  private _node: ListNodeImpl;\n  /** @internal */\n  private _reverse: boolean;\n  /** @internal */\n  private _dl: List<T>;\n  constructor(dl: List<T>, node: ListNodeImpl, reverse: boolean) {\n    this._dl = dl;\n    this._node = node;\n    this._reverse = reverse;\n  }\n  valid(): boolean {\n    return this._node !== this._dl.head;\n  }\n  next(): ListIterator<T> {\n    if (this.valid()) {\n      this._node = this._reverse ? this._node.prev : this._node.next;\n    }\n    return this;\n  }\n  getNext(): ListIterator<T> {\n    if (!this.valid()) {\n      throw new Error('Failed to get next iterator: this iterator is invalid');\n    }\n    return new ListIterator<T>(\n      this._dl,\n      this._reverse ? this._node.prev : this._node.next,\n      this._reverse,\n    );\n  }\n  prev(): ListIterator<T> {\n    if (this.valid()) {\n      this._node = this._reverse ? this._node.next : this._node.prev;\n    }\n    return this;\n  }\n  getPrev(): ListIterator<T> {\n    if (!this.valid()) {\n      throw new Error('Failed to get previous iterator: this iterator is invalid');\n    }\n    return new ListIterator<T>(\n      this._dl,\n      this._reverse ? this._node.next : this._node.prev,\n      this._reverse,\n    );\n  }\n  get node() {\n    return this._node;\n  }\n  set node(n: ListNodeImpl) {\n    this._node = n;\n  }\n  get reversed() {\n    return this._reverse;\n  }\n  get list() {\n    return this._dl;\n  }\n  get data() {\n    if (this.valid()) {\n      return (this._node as ListNode<T>).data;\n    } else {\n      throw new Error('Invalid interator');\n    }\n  }\n  set data(val: T) {\n    if (this.valid()) {\n      (this._node as ListNode<T>).data = val;\n    }\n  }\n}\n\nexport class List<T = unknown> {\n  /** @internal */\n  private _head: ListNodeImpl;\n  /** @internal */\n  private _length: number;\n  constructor() {\n    this._head = new ListNodeImpl();\n    this._length = 0;\n  }\n  get head() {\n    return this._head;\n  }\n  get length() {\n    return this._length;\n  }\n  clear() {\n    while (this._length > 0) {\n      this.remove(this.begin());\n    }\n  }\n  append(data: T): ListIterator<T> {\n    return this._insertAt(data, this._head);\n  }\n  prepend(data: T): ListIterator<T> {\n    return this._insertAt(data, this._head.next);\n  }\n  removeAndAppend(it: ListIterator<T>): void {\n    this._move(it, this._head);\n  }\n  removeAndPrepend(it: ListIterator<T>) {\n    this._move(it, this._head.next);\n  }\n  remove(it: ListIterator<T>): void {\n    if (it.valid() && it.list === this) {\n      const node = it.node;\n      it.next();\n      this._remove(node);\n    }\n  }\n  insertAt(data: T, at: ListIterator<T>): ListIterator<T> {\n    if (at.list === this) {\n      if (at.valid()) {\n        if (at.reversed) {\n          return this._insertAt(data, at.node.next);\n        } else {\n          return this._insertAt(data, at.node);\n        }\n      } else {\n        return this.append(data);\n      }\n    }\n    return null;\n  }\n  forEach(callback: (data: T) => void) {\n    for (let it = this.begin(); it.valid(); it.next()) {\n      callback && callback(it.data);\n    }\n  }\n  forEachReverse(callback: (data: T) => void) {\n    for (let it = this.rbegin(); it.valid(); it.next()) {\n      callback && callback(it.data);\n    }\n  }\n  front(): T {\n    return this.begin().data;\n  }\n  back(): T {\n    return this.rbegin().data;\n  }\n  begin(): ListIterator<T> {\n    return new ListIterator(this, this._length > 0 ? this._head.next : this._head, false);\n  }\n  rbegin(): ListIterator<T> {\n    return new ListIterator(this, this._length > 0 ? this._head.prev : this._head, true);\n  }\n  /** @internal */\n  private _remove(node: ListNodeImpl) {\n    node.prev.next = node.next;\n    node.next.prev = node.prev;\n    delete node.prev;\n    delete node.next;\n    this._length--;\n  }\n  /** @internal */\n  private _insertAt(data: T, node: ListNodeImpl): ListIterator<T> {\n    const newNode = new ListNode(data);\n    newNode.next = node;\n    newNode.prev = node.prev;\n    node.prev.next = newNode;\n    node.prev = newNode;\n    this._length++;\n    return new ListIterator(this, newNode, false);\n  }\n  /** @internal */\n  private _move(iter: ListIterator<T>, at: ListNodeImpl) {\n    const node = iter.node;\n    node.prev.next = node.next;\n    node.next.prev = node.prev;\n    node.next = at;\n    node.prev = at.prev;\n    at.prev.next = node;\n    at.prev = node;\n  }\n}\n\nclass ListNodeImpl {\n  next: ListNodeImpl;\n  prev: ListNodeImpl;\n  constructor() {\n    this.next = this;\n    this.prev = this;\n  }\n}\n\nclass ListNode<T = unknown> extends ListNodeImpl {\n  data: T;\n  constructor(data: T) {\n    super();\n    this.data = data;\n  }\n}\n"],"names":[],"mappings":"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"}