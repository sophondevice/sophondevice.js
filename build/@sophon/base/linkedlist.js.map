{"version":3,"file":"linkedlist.js","sources":["../../../libs/base/src/linkedlist.ts"],"sourcesContent":["export class ListIterator<T = unknown> {\r\n  /** @internal */\r\n  private _node: ListNodeImpl;\r\n  /** @internal */\r\n  private _reverse: boolean;\r\n  /** @internal */\r\n  private _dl: List<T>;\r\n  constructor(dl: List<T>, node: ListNodeImpl, reverse: boolean) {\r\n    this._dl = dl;\r\n    this._node = node;\r\n    this._reverse = reverse;\r\n  }\r\n  valid(): boolean {\r\n    return this._node !== this._dl.head;\r\n  }\r\n  next(): ListIterator<T> {\r\n    if (this.valid()) {\r\n      this._node = this._reverse ? this._node.prev : this._node.next;\r\n    }\r\n    return this;\r\n  }\r\n  getNext(): ListIterator<T> {\r\n    if (!this.valid()) {\r\n      throw new Error('Failed to get next iterator: this iterator is invalid');\r\n    }\r\n    return new ListIterator<T>(\r\n      this._dl,\r\n      this._reverse ? this._node.prev : this._node.next,\r\n      this._reverse,\r\n    );\r\n  }\r\n  prev(): ListIterator<T> {\r\n    if (this.valid()) {\r\n      this._node = this._reverse ? this._node.next : this._node.prev;\r\n    }\r\n    return this;\r\n  }\r\n  getPrev(): ListIterator<T> {\r\n    if (!this.valid()) {\r\n      throw new Error('Failed to get previous iterator: this iterator is invalid');\r\n    }\r\n    return new ListIterator<T>(\r\n      this._dl,\r\n      this._reverse ? this._node.next : this._node.prev,\r\n      this._reverse,\r\n    );\r\n  }\r\n  get node() {\r\n    return this._node;\r\n  }\r\n  set node(n: ListNodeImpl) {\r\n    this._node = n;\r\n  }\r\n  get reversed() {\r\n    return this._reverse;\r\n  }\r\n  get list() {\r\n    return this._dl;\r\n  }\r\n  get data() {\r\n    if (this.valid()) {\r\n      return (this._node as ListNode<T>).data;\r\n    } else {\r\n      throw new Error('Invalid interator');\r\n    }\r\n  }\r\n  set data(val: T) {\r\n    if (this.valid()) {\r\n      (this._node as ListNode<T>).data = val;\r\n    }\r\n  }\r\n}\r\n\r\nexport class List<T = unknown> {\r\n  /** @internal */\r\n  private _head: ListNodeImpl;\r\n  /** @internal */\r\n  private _length: number;\r\n  constructor() {\r\n    this._head = new ListNodeImpl();\r\n    this._length = 0;\r\n  }\r\n  get head() {\r\n    return this._head;\r\n  }\r\n  get length() {\r\n    return this._length;\r\n  }\r\n  clear() {\r\n    while (this._length > 0) {\r\n      this.remove(this.begin());\r\n    }\r\n  }\r\n  append(data: T): ListIterator<T> {\r\n    return this._insertAt(data, this._head);\r\n  }\r\n  prepend(data: T): ListIterator<T> {\r\n    return this._insertAt(data, this._head.next);\r\n  }\r\n  removeAndAppend(it: ListIterator<T>): void {\r\n    this._move(it, this._head);\r\n  }\r\n  removeAndPrepend(it: ListIterator<T>) {\r\n    this._move(it, this._head.next);\r\n  }\r\n  remove(it: ListIterator<T>): void {\r\n    if (it.valid() && it.list === this) {\r\n      const node = it.node;\r\n      it.next();\r\n      this._remove(node);\r\n    }\r\n  }\r\n  insertAt(data: T, at: ListIterator<T>): ListIterator<T> {\r\n    if (at.list === this) {\r\n      if (at.valid()) {\r\n        if (at.reversed) {\r\n          return this._insertAt(data, at.node.next);\r\n        } else {\r\n          return this._insertAt(data, at.node);\r\n        }\r\n      } else {\r\n        return this.append(data);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  forEach(callback: (data: T) => void) {\r\n    for (let it = this.begin(); it.valid(); it.next()) {\r\n      callback && callback(it.data);\r\n    }\r\n  }\r\n  forEachReverse(callback: (data: T) => void) {\r\n    for (let it = this.rbegin(); it.valid(); it.next()) {\r\n      callback && callback(it.data);\r\n    }\r\n  }\r\n  front(): T {\r\n    return this.begin().data;\r\n  }\r\n  back(): T {\r\n    return this.rbegin().data;\r\n  }\r\n  begin(): ListIterator<T> {\r\n    return new ListIterator(this, this._length > 0 ? this._head.next : this._head, false);\r\n  }\r\n  rbegin(): ListIterator<T> {\r\n    return new ListIterator(this, this._length > 0 ? this._head.prev : this._head, true);\r\n  }\r\n  /** @internal */\r\n  private _remove(node: ListNodeImpl) {\r\n    node.prev.next = node.next;\r\n    node.next.prev = node.prev;\r\n    delete node.prev;\r\n    delete node.next;\r\n    this._length--;\r\n  }\r\n  /** @internal */\r\n  private _insertAt(data: T, node: ListNodeImpl): ListIterator<T> {\r\n    const newNode = new ListNode(data);\r\n    newNode.next = node;\r\n    newNode.prev = node.prev;\r\n    node.prev.next = newNode;\r\n    node.prev = newNode;\r\n    this._length++;\r\n    return new ListIterator(this, newNode, false);\r\n  }\r\n  /** @internal */\r\n  private _move(iter: ListIterator<T>, at: ListNodeImpl) {\r\n    const node = iter.node;\r\n    node.prev.next = node.next;\r\n    node.next.prev = node.prev;\r\n    node.next = at;\r\n    node.prev = at.prev;\r\n    at.prev.next = node;\r\n    at.prev = node;\r\n  }\r\n}\r\n\r\nclass ListNodeImpl {\r\n  next: ListNodeImpl;\r\n  prev: ListNodeImpl;\r\n  constructor() {\r\n    this.next = this;\r\n    this.prev = this;\r\n  }\r\n}\r\n\r\nclass ListNode<T = unknown> extends ListNodeImpl {\r\n  data: T;\r\n  constructor(data: T) {\r\n    super();\r\n    this.data = data;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}