{"version":3,"file":"quadtree.js","sources":["../../../../../libs/device/src/scene/terrain/quadtree.ts"],"sourcesContent":["import { ClipState, Frustum, Matrix4x4, Vector3, isPowerOf2, nextPowerOf2 } from '@sophon/base';\nimport { PatchPosition } from './types';\nimport { BoundingBox } from '../bounding_volume';\nimport { TerrainPatch } from './patch';\nimport { IndexBuffer, makeVertexBufferType, PrimitiveType, StructuredBuffer, Texture2D, TextureFormat } from '../../device';\nimport { HeightField } from './heightfield';\nimport type { Terrain } from './terrain';\nimport type { Camera } from '../camera';\nimport type { Scene } from '../scene';\n\nexport class QuadtreeNode {\n  private _patch: TerrainPatch;\n  private _parent: QuadtreeNode;\n  private _children: QuadtreeNode[];\n  constructor() {\n    this._patch = null;\n    this._parent = null;\n    this._children = null;\n  }\n  initialize(scene: Scene, quadtree: Quadtree, parent: QuadtreeNode, position: PatchPosition, baseVertices: StructuredBuffer, normals: Float32Array, elevations: Float32Array): boolean {\n    this._parent = parent;\n    this._children = [];\n    this._patch = new TerrainPatch();\n    if (!this._patch.initialize(scene, quadtree, this._parent?._patch || null, position, baseVertices, normals, elevations)) {\n      return false;\n    }\n    if (this._patch.getStep() > 1) {\n      let bbox: BoundingBox = null;\n      const size = (quadtree.getPatchSize() - 1) * (this._patch.getStep() >> 1);\n      const offsetX = this._patch.getOffsetX();\n      const offsetZ = this._patch.getOffsetZ();\n      const offsets = [\n        [offsetX, offsetZ],\n        [offsetX + size, offsetZ],\n        [offsetX, offsetZ + size],\n        [offsetX + size, offsetZ + size]\n      ];\n      const rootSizeX = quadtree.getRootSizeX() - 1;\n      const rootSizeZ = quadtree.getRootSizeZ() - 1;\n      for (let i = 0; i < 4; ++i) {\n        if (offsets[i][0] >= rootSizeX || offsets[i][1] >= rootSizeZ) {\n          this._children[i] = null;\n        } else {\n          this._children[i] = new QuadtreeNode();\n          if (!this._children[i].initialize(scene, quadtree, this, i, baseVertices, normals, elevations)) {\n            return false;\n          }\n          const childBBox = this._children[i]._patch.getBoundingBox();\n          if (childBBox) {\n            if (!bbox) {\n              bbox = new BoundingBox();\n              bbox.beginExtend();\n            }\n            bbox.extend(childBBox.minPoint);\n            bbox.extend(childBBox.maxPoint);\n          }\n        }\n      }\n      this._patch.setBoundingBox(bbox);\n    }\n    quadtree.addPatch(this._patch);\n    return true;\n  }\n  setupCamera(viewportH: number, tanHalfFovy: number, maxPixelError: number): void {\n    if (this._patch && !this._patch.isDummy()) {\n      this._patch.setupCamera(viewportH, tanHalfFovy, maxPixelError);\n    }\n    for (let i = 0; i < 4; ++i) {\n      if (this._children[i]) {\n        this._children[i].setupCamera(viewportH, tanHalfFovy, maxPixelError);\n      }\n    }\n  }\n  getBoundingbox(): BoundingBox {\n    return this._patch.getBoundingBox();\n  }\n  getPatch(): TerrainPatch {\n    return this._patch;\n  }\n  getParent(): QuadtreeNode {\n    return this._parent;\n  }\n  getChild(index: number): QuadtreeNode {\n    return this._children[index];\n  }\n}\n\nexport class Quadtree {\n  private _baseVertices: StructuredBuffer;\n  private _indices: IndexBuffer;\n  private _indicesWireframe: IndexBuffer;\n  private _normalMap: Texture2D;\n  private _scaleX: number;\n  private _scaleZ: number;\n  private _patchSize: number;\n  private _rootSizeX: number;\n  private _rootSizeZ: number;\n  private _rootSize: number;\n  private _primitiveCount: number;\n  private _primitiveType: PrimitiveType;\n  private _rootNode: QuadtreeNode;\n  private _terrain: Terrain;\n  private _heightField: HeightField;\n  private _patches: TerrainPatch[];\n  constructor(terrain: Terrain) {\n    this._terrain = terrain;\n    this._baseVertices = null;\n    this._indices = null;\n    this._indicesWireframe = null;\n    this._normalMap = null;\n    this._scaleX = 1;\n    this._scaleZ = 1;\n    this._patchSize = 0;\n    this._rootSizeX = 0;\n    this._rootSizeZ = 0;\n    this._rootSize = 0;\n    this._heightField = null;\n    this._rootNode = null;\n    this._primitiveCount = 0;\n    this._primitiveType = PrimitiveType.TriangleStrip;\n    this._patches = [];\n  }\n  get normalMap(): Texture2D {\n    return this._normalMap;\n  }\n  build(scene: Scene, patchSize: number, rootSizeX: number, rootSizeZ: number, elevations: Float32Array, scaleX: number, scaleZ: number, vertexCacheSize: number): boolean {\n    const device = scene.device;\n    if (!isPowerOf2(patchSize - 1)\n      || !!((rootSizeX - 1) % (patchSize - 1))\n      || !!((rootSizeZ - 1) % (patchSize - 1))\n      || !elevations) {\n      return false;\n    }\n    this._heightField = new HeightField();\n    if (!this._heightField.init(rootSizeX, rootSizeZ, 0, 0, scaleX, scaleZ, 1, elevations, patchSize)) {\n      this._heightField = null;\n      return false;\n    }\n    this._patchSize = patchSize;\n    this._rootSizeX = rootSizeX;\n    this._rootSizeZ = rootSizeZ;\n    this._rootSize = nextPowerOf2(Math.max((rootSizeX - 1), (rootSizeZ - 1))) + 1;\n    this._scaleX = scaleX;\n    this._scaleZ = scaleZ;\n    // Create base vertex buffer\n    const dimension = patchSize + 2; // with \"skirts\"\n    const vertices = new Float32Array(dimension * dimension * 3);\n    let offset = 0;\n    // top skirt\n    vertices[0] = 0;\n    vertices[1] = 0;\n    vertices[2] = 0;\n    for (let i = 1; i < dimension - 1; ++i) {\n      vertices[3 * i + 0] = i - 1;\n      vertices[3 * i + 1] = 0;\n      vertices[3 * i + 2] = 0;\n    }\n    vertices[3 * (dimension - 1) + 0] = dimension - 3;\n    vertices[3 * (dimension - 1) + 1] = 0;\n    vertices[3 * (dimension - 1) + 2] = 0;\n    offset += dimension * 3;\n    for (let i = 1; i < dimension - 1; ++i, offset += dimension * 3) {\n      // left skirt\n      vertices[offset + 0] = 0;\n      vertices[offset + 1] = 0;\n      vertices[offset + 2] = i - 1;\n      // height\n      for (let j = 1; j < dimension - 1; ++j) {\n        vertices[offset + 3 * j + 0] = j - 1;\n        vertices[offset + 3 * j + 1] = 0;\n        vertices[offset + 3 * j + 2] = i - 1;\n      }\n      // right skirt\n      vertices[offset + (dimension - 1) * 3 + 0] = dimension - 3;\n      vertices[offset + (dimension - 1) * 3 + 1] = 0;\n      vertices[offset + (dimension - 1) * 3 + 2] = i - 1;\n    }\n    // bottom skirt\n    vertices[offset + 0] = 0;\n    vertices[offset + 1] = 0;\n    vertices[offset + 2] = dimension - 3;\n    for (let i = 1; i < dimension - 1; ++i) {\n      vertices[offset + 3 * i + 0] = i - 1;\n      vertices[offset + 3 * i + 1] = 0;\n      vertices[offset + 3 * i + 2] = dimension - 3;\n    }\n    vertices[offset + (dimension - 1) * 3 + 0] = dimension - 3;\n    vertices[offset + (dimension - 1) * 3 + 1] = 0;\n    vertices[offset + (dimension - 1) * 3 + 2] = dimension - 3;\n    this._baseVertices = device.createStructuredBuffer(makeVertexBufferType(dimension * dimension, 'position_f32x3'), { usage: 'vertex', managed: true }, vertices);\n    // Create base index buffer\n    const indices = this.strip(vertexCacheSize);\n    this._indices = device.createIndexBuffer(indices, { managed: true });\n    const lineIndices = this.line(indices);\n    this._indicesWireframe = device.createIndexBuffer(lineIndices, { managed: true });\n    this._primitiveCount = indices.length - 2;\n    this._primitiveType = PrimitiveType.TriangleStrip;\n    this._rootNode = new QuadtreeNode();\n    const normals = this._heightField.computeNormalVectors();\n    const normalMapBytes = new Uint8Array(normals.length / 3 * 4);\n    for (let i = 0; i < normals.length / 3; i++) {\n      normalMapBytes[i * 4 + 0] = Math.floor((normals[i * 3 + 0] * 0.5 + 0.5) * 255);\n      normalMapBytes[i * 4 + 1] = Math.floor((normals[i * 3 + 1] * 0.5 + 0.5) * 255);\n      normalMapBytes[i * 4 + 2] = Math.floor((normals[i * 3 + 2] * 0.5 + 0.5) * 255);\n      normalMapBytes[i * 4 + 3] = 255;\n    }\n    this._normalMap = device.createTexture2D(TextureFormat.RGBA8UNORM, rootSizeX, rootSizeZ, { colorSpace: 'linear' });\n    this._normalMap.name = `TerrainNormalMap-${this._normalMap.uid}`;\n    this._normalMap.update(normalMapBytes, 0, 0, this._normalMap.width, this._normalMap.height);\n    return this._rootNode.initialize(scene, this, null, PatchPosition.LeftTop, this._baseVertices, normals, elevations);\n  }\n  strip(vertexCacheSize: number): Uint16Array {\n    const dimension = this._patchSize + 2;\n    const step = (vertexCacheSize >> 1) - 1;\n    const indices: number[] = [];\n    for (let i = 0; i < dimension - 1; i += step) {\n      const start = i;\n      const end = (i + step > dimension - 1) ? dimension - 1 : i + step;\n      for (let j = 0; j < dimension - 1; ++j) {\n        for (let k = start; k <= end; ++k) {\n          indices.push((dimension - 1 - k) * dimension + j);\n          indices.push((dimension - 1 - k) * dimension + j + 1);\n        }\n        indices.push((dimension - 1 - end) * dimension + j + 1);\n        indices.push((j == dimension - 2) ? (dimension - 1 - end) * dimension : (dimension - 1 - start) * dimension + j + 1);\n      }\n    }\n    indices.length = indices.length - 2;\n    return new Uint16Array(indices);\n  }\n  line(strip: Uint16Array): Uint16Array {\n    const numTris = strip.length - 2;\n    const lineIndices: number[] = [];\n    let lastSkipped = true;\n    let a: number, b: number, c: number;\n    for (let i = 0; i < numTris; i++) {\n      if (i % 2 === 0) {\n        a = strip[i];\n        b = strip[i + 1];\n        c = strip[i + 2];\n      } else {\n        a = strip[i + 1];\n        b = strip[i];\n        c = strip[i + 2];\n      }\n      const thisSkipped = a === b || a === c || b === c;\n      if (!thisSkipped) {\n        if (lastSkipped) {\n          lineIndices.push(a, b);\n        }\n        lineIndices.push(b, c, c, a);\n      }\n      lastSkipped = thisSkipped;\n    }\n    return new Uint16Array(lineIndices);\n  }\n  setupCamera(viewportH: number, tanHalfFovy: number, maxPixelError: number): void {\n    this._rootNode?.setupCamera(viewportH, tanHalfFovy, maxPixelError);\n  }\n  getBoundingBox(bbox: BoundingBox): void {\n    if (this._heightField) {\n      bbox.minPoint = this._heightField.getBoundingbox().minPoint;\n      bbox.maxPoint = this._heightField.getBoundingbox().maxPoint;\n    } else {\n      bbox.minPoint = Vector3.zero();\n      bbox.maxPoint = Vector3.zero();\n    }\n  }\n  getPatchSize(): number {\n    return this._patchSize;\n  }\n  getRootSize(): number {\n    return this._rootSize;\n  }\n  getRootSizeX(): number {\n    return this._rootSizeX;\n  }\n  getRootSizeZ(): number {\n    return this._rootSizeZ;\n  }\n  getTerrain(): Terrain {\n    return this._terrain;\n  }\n  getElevations(): Float32Array {\n    return this._heightField?.getHeights() || null;\n  }\n  getScaleX(): number {\n    return this._scaleX;\n  }\n  getScaleZ(): number {\n    return this._scaleZ;\n  }\n  getIndices(): IndexBuffer {\n    return this._indices;\n  }\n  getIndicesWireframe(): IndexBuffer {\n    return this._indicesWireframe;\n  }\n  getPrimitiveCount(): number {\n    return this._primitiveCount;\n  }\n  getPrimitiveType(): PrimitiveType {\n    return this._primitiveType;\n  }\n  getHeightField(): HeightField {\n    return this._heightField;\n  }\n  getPatches(): TerrainPatch[] {\n    return this._patches;\n  }\n  /** @internal */\n  addPatch(patch: TerrainPatch) {\n    this._patches.push(patch);\n  }\n  /** @internal */\n  cull(camera: Camera, viewPoint: Vector3, worldMatrix: Matrix4x4) {\n    if (this._rootNode && this._terrain) {\n      const frustum = new Frustum(camera.viewProjectionMatrix, worldMatrix);\n      this.cull_r(camera, this._rootNode, viewPoint, worldMatrix, frustum, true);\n    }\n  }\n  /** @internal */\n  cull_r(camera: Camera, node: QuadtreeNode, viewPoint: Vector3, worldMatrix: Matrix4x4, frustum: Frustum, cliptest: boolean) {\n    const bbox = node.getBoundingbox();\n    if (cliptest) {\n      const clipState = bbox.getClipStateWithFrustum(frustum);\n      if (clipState === ClipState.NOT_CLIPPED) {\n        return;\n      } else if (clipState === ClipState.A_INSIDE_B) {\n        cliptest = false;\n      }\n    }\n    const ld = node.getPatch().isDummy() ? -1 : node.getPatch().getLODDistance();\n    const lodDistance = ld >= 0 ? ld * ld : Number.MAX_VALUE;\n    const eyeDistSq = ld >= 0 ? node.getPatch().sqrDistanceToPoint(viewPoint) : 0;\n    const lodLevel = this._terrain.detailLODLevel;\n    if (eyeDistSq < lodDistance && node.getChild(0) && (lodLevel === 0 || node.getPatch().getMipLevel() < lodLevel)) {\n      for (let i = 0; i < 4; i++) {\n        const child = node.getChild(i);\n        if (child) {\n          this.cull_r(camera, child, viewPoint, worldMatrix, frustum, cliptest);\n        }\n      }\n    } else if (!node.getPatch().isDummy()) {\n      this._terrain.addPatch(node.getPatch(), true);\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;MAUa,YAAY,CAAA;AACf,IAAA,MAAM,CAAe;AACrB,IAAA,OAAO,CAAe;AACtB,IAAA,SAAS,CAAiB;AAClC,IAAA,WAAA,GAAA;AACE,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACnB,QAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACpB,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;KACvB;AACD,IAAA,UAAU,CAAC,KAAY,EAAE,QAAkB,EAAE,MAAoB,EAAE,QAAuB,EAAE,YAA8B,EAAE,OAAqB,EAAE,UAAwB,EAAA;AACzK,QAAA,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AACtB,QAAA,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;AACpB,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,YAAY,EAAE,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,OAAO,EAAE,MAAM,IAAI,IAAI,EAAE,QAAQ,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE;AACvH,YAAA,OAAO,KAAK,CAAC;AACd,SAAA;QACD,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC,EAAE;YAC7B,IAAI,IAAI,GAAgB,IAAI,CAAC;YAC7B,MAAM,IAAI,GAAG,CAAC,QAAQ,CAAC,YAAY,EAAE,GAAG,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;YAC1E,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC;YACzC,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC;AACzC,YAAA,MAAM,OAAO,GAAG;gBACd,CAAC,OAAO,EAAE,OAAO,CAAC;AAClB,gBAAA,CAAC,OAAO,GAAG,IAAI,EAAE,OAAO,CAAC;AACzB,gBAAA,CAAC,OAAO,EAAE,OAAO,GAAG,IAAI,CAAC;AACzB,gBAAA,CAAC,OAAO,GAAG,IAAI,EAAE,OAAO,GAAG,IAAI,CAAC;aACjC,CAAC;YACF,MAAM,SAAS,GAAG,QAAQ,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;YAC9C,MAAM,SAAS,GAAG,QAAQ,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;YAC9C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AAC1B,gBAAA,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,SAAS,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,SAAS,EAAE;AAC5D,oBAAA,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;AAC1B,iBAAA;AAAM,qBAAA;oBACL,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,YAAY,EAAE,CAAC;oBACvC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE;AAC9F,wBAAA,OAAO,KAAK,CAAC;AACd,qBAAA;AACD,oBAAA,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC;AAC5D,oBAAA,IAAI,SAAS,EAAE;wBACb,IAAI,CAAC,IAAI,EAAE;AACT,4BAAA,IAAI,GAAG,IAAI,WAAW,EAAE,CAAC;4BACzB,IAAI,CAAC,WAAW,EAAE,CAAC;AACpB,yBAAA;AACD,wBAAA,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;AAChC,wBAAA,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;AACjC,qBAAA;AACF,iBAAA;AACF,aAAA;AACD,YAAA,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;AAClC,SAAA;AACD,QAAA,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAC/B,QAAA,OAAO,IAAI,CAAC;KACb;AACD,IAAA,WAAW,CAAC,SAAiB,EAAE,WAAmB,EAAE,aAAqB,EAAA;QACvE,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE;YACzC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;AAChE,SAAA;QACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AAC1B,YAAA,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;AACrB,gBAAA,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,SAAS,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;AACtE,aAAA;AACF,SAAA;KACF;IACD,cAAc,GAAA;AACZ,QAAA,OAAO,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC;KACrC;IACD,QAAQ,GAAA;QACN,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;IACD,SAAS,GAAA;QACP,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;AACD,IAAA,QAAQ,CAAC,KAAa,EAAA;AACpB,QAAA,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;KAC9B;AACF,CAAA;MAEY,QAAQ,CAAA;AACX,IAAA,aAAa,CAAmB;AAChC,IAAA,QAAQ,CAAc;AACtB,IAAA,iBAAiB,CAAc;AAC/B,IAAA,UAAU,CAAY;AACtB,IAAA,OAAO,CAAS;AAChB,IAAA,OAAO,CAAS;AAChB,IAAA,UAAU,CAAS;AACnB,IAAA,UAAU,CAAS;AACnB,IAAA,UAAU,CAAS;AACnB,IAAA,SAAS,CAAS;AAClB,IAAA,eAAe,CAAS;AACxB,IAAA,cAAc,CAAgB;AAC9B,IAAA,SAAS,CAAe;AACxB,IAAA,QAAQ,CAAU;AAClB,IAAA,YAAY,CAAc;AAC1B,IAAA,QAAQ,CAAiB;AACjC,IAAA,WAAA,CAAY,OAAgB,EAAA;AAC1B,QAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;AACxB,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC1B,QAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACrB,QAAA,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;AAC9B,QAAA,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AACvB,QAAA,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;AACjB,QAAA,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;AACjB,QAAA,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;AACpB,QAAA,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;AACpB,QAAA,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;AACpB,QAAA,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;AACnB,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AACtB,QAAA,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;AACzB,QAAA,IAAI,CAAC,cAAc,GAAG,aAAa,CAAC,aAAa,CAAC;AAClD,QAAA,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;KACpB;AACD,IAAA,IAAI,SAAS,GAAA;QACX,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;AACD,IAAA,KAAK,CAAC,KAAY,EAAE,SAAiB,EAAE,SAAiB,EAAE,SAAiB,EAAE,UAAwB,EAAE,MAAc,EAAE,MAAc,EAAE,eAAuB,EAAA;AAC5J,QAAA,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;AAC5B,QAAA,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,CAAC;AACzB,eAAA,CAAC,EAAE,CAAC,SAAS,GAAG,CAAC,KAAK,SAAS,GAAG,CAAC,CAAC,CAAC;AACrC,eAAA,CAAC,EAAE,CAAC,SAAS,GAAG,CAAC,KAAK,SAAS,GAAG,CAAC,CAAC,CAAC;AACrC,eAAA,CAAC,UAAU,EAAE;AAChB,YAAA,OAAO,KAAK,CAAC;AACd,SAAA;AACD,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI,WAAW,EAAE,CAAC;QACtC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC,EAAE,UAAU,EAAE,SAAS,CAAC,EAAE;AACjG,YAAA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,YAAA,OAAO,KAAK,CAAC;AACd,SAAA;AACD,QAAA,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;AAC5B,QAAA,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;AAC5B,QAAA,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,GAAG,EAAE,SAAS,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;AAC9E,QAAA,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AACtB,QAAA,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AAEtB,QAAA,MAAM,SAAS,GAAG,SAAS,GAAG,CAAC,CAAC;QAChC,MAAM,QAAQ,GAAG,IAAI,YAAY,CAAC,SAAS,GAAG,SAAS,GAAG,CAAC,CAAC,CAAC;QAC7D,IAAI,MAAM,GAAG,CAAC,CAAC;AAEf,QAAA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AAChB,QAAA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AAChB,QAAA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AAChB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YACtC,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC5B,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;YACxB,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACzB,SAAA;AACD,QAAA,QAAQ,CAAC,CAAC,IAAI,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AAClD,QAAA,QAAQ,CAAC,CAAC,IAAI,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACtC,QAAA,QAAQ,CAAC,CAAC,IAAI,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACtC,QAAA,MAAM,IAAI,SAAS,GAAG,CAAC,CAAC;AACxB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE,MAAM,IAAI,SAAS,GAAG,CAAC,EAAE;AAE/D,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACzB,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;YACzB,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAE7B,YAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AACtC,gBAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBACrC,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACjC,gBAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACtC,aAAA;AAED,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AAC3D,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/C,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACpD,SAAA;AAED,QAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACzB,QAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QACzB,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AACrC,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AACtC,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YACrC,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACjC,YAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AAC9C,SAAA;AACD,QAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AAC3D,QAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/C,QAAA,QAAQ,CAAC,MAAM,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;AAC3D,QAAA,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC,sBAAsB,CAAC,oBAAoB,CAAC,SAAS,GAAG,SAAS,EAAE,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,QAAQ,CAAC,CAAC;QAEhK,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;AAC5C,QAAA,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,iBAAiB,CAAC,OAAO,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QACrE,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACvC,QAAA,IAAI,CAAC,iBAAiB,GAAG,MAAM,CAAC,iBAAiB,CAAC,WAAW,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAClF,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;AAC1C,QAAA,IAAI,CAAC,cAAc,GAAG,aAAa,CAAC,aAAa,CAAC;AAClD,QAAA,IAAI,CAAC,SAAS,GAAG,IAAI,YAAY,EAAE,CAAC;QACpC,MAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,oBAAoB,EAAE,CAAC;AACzD,QAAA,MAAM,cAAc,GAAG,IAAI,UAAU,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AAC9D,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAC3C,YAAA,cAAc,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;AAC/E,YAAA,cAAc,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;AAC/E,YAAA,cAAc,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;YAC/E,cAAc,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;AACjC,SAAA;QACD,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,UAAU,EAAE,QAAQ,EAAE,CAAC,CAAC;AACnH,QAAA,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,CAAA,iBAAA,EAAoB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAA,CAAE,CAAC;QACjE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAC5F,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,aAAa,CAAC,OAAO,EAAE,IAAI,CAAC,aAAa,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;KACrH;AACD,IAAA,KAAK,CAAC,eAAuB,EAAA;AAC3B,QAAA,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;QACtC,MAAM,IAAI,GAAG,CAAC,eAAe,IAAI,CAAC,IAAI,CAAC,CAAC;QACxC,MAAM,OAAO,GAAa,EAAE,CAAC;AAC7B,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI,EAAE;YAC5C,MAAM,KAAK,GAAG,CAAC,CAAC;YAChB,MAAM,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,GAAG,SAAS,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;AAClE,YAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBACtC,KAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,IAAI,GAAG,EAAE,EAAE,CAAC,EAAE;AACjC,oBAAA,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;AAClD,oBAAA,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACvD,iBAAA;AACD,gBAAA,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,GAAG,GAAG,IAAI,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACxD,gBAAA,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,SAAS,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,GAAG,GAAG,IAAI,SAAS,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,KAAK,IAAI,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACtH,aAAA;AACF,SAAA;QACD,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;AACpC,QAAA,OAAO,IAAI,WAAW,CAAC,OAAO,CAAC,CAAC;KACjC;AACD,IAAA,IAAI,CAAC,KAAkB,EAAA;AACrB,QAAA,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;QACjC,MAAM,WAAW,GAAa,EAAE,CAAC;QACjC,IAAI,WAAW,GAAG,IAAI,CAAC;AACvB,QAAA,IAAI,CAAS,EAAE,CAAS,EAAE,CAAS,CAAC;QACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;AAChC,YAAA,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;AACf,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AACb,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AACjB,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AAClB,aAAA;AAAM,iBAAA;AACL,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AACjB,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AACb,gBAAA,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AAClB,aAAA;AACD,YAAA,MAAM,WAAW,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAClD,IAAI,CAAC,WAAW,EAAE;AAChB,gBAAA,IAAI,WAAW,EAAE;AACf,oBAAA,WAAW,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACxB,iBAAA;gBACD,WAAW,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAC9B,aAAA;YACD,WAAW,GAAG,WAAW,CAAC;AAC3B,SAAA;AACD,QAAA,OAAO,IAAI,WAAW,CAAC,WAAW,CAAC,CAAC;KACrC;AACD,IAAA,WAAW,CAAC,SAAiB,EAAE,WAAmB,EAAE,aAAqB,EAAA;QACvE,IAAI,CAAC,SAAS,EAAE,WAAW,CAAC,SAAS,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;KACpE;AACD,IAAA,cAAc,CAAC,IAAiB,EAAA;QAC9B,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;YAC5D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;AAC7D,SAAA;AAAM,aAAA;AACL,YAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC;AAC/B,YAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC;AAChC,SAAA;KACF;IACD,YAAY,GAAA;QACV,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;IACD,WAAW,GAAA;QACT,OAAO,IAAI,CAAC,SAAS,CAAC;KACvB;IACD,YAAY,GAAA;QACV,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;IACD,YAAY,GAAA;QACV,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;IACD,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;IACD,aAAa,GAAA;QACX,OAAO,IAAI,CAAC,YAAY,EAAE,UAAU,EAAE,IAAI,IAAI,CAAC;KAChD;IACD,SAAS,GAAA;QACP,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;IACD,SAAS,GAAA;QACP,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;IACD,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;IACD,mBAAmB,GAAA;QACjB,OAAO,IAAI,CAAC,iBAAiB,CAAC;KAC/B;IACD,iBAAiB,GAAA;QACf,OAAO,IAAI,CAAC,eAAe,CAAC;KAC7B;IACD,gBAAgB,GAAA;QACd,OAAO,IAAI,CAAC,cAAc,CAAC;KAC5B;IACD,cAAc,GAAA;QACZ,OAAO,IAAI,CAAC,YAAY,CAAC;KAC1B;IACD,UAAU,GAAA;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;AAED,IAAA,QAAQ,CAAC,KAAmB,EAAA;AAC1B,QAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC3B;AAED,IAAA,IAAI,CAAC,MAAc,EAAE,SAAkB,EAAE,WAAsB,EAAA;AAC7D,QAAA,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,QAAQ,EAAE;YACnC,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,MAAM,CAAC,oBAAoB,EAAE,WAAW,CAAC,CAAC;AACtE,YAAA,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE,SAAS,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;AAC5E,SAAA;KACF;IAED,MAAM,CAAC,MAAc,EAAE,IAAkB,EAAE,SAAkB,EAAE,WAAsB,EAAE,OAAgB,EAAE,QAAiB,EAAA;AACxH,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;AACnC,QAAA,IAAI,QAAQ,EAAE;YACZ,MAAM,SAAS,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;AACxD,YAAA,IAAI,SAAS,KAAK,SAAS,CAAC,WAAW,EAAE;gBACvC,OAAO;AACR,aAAA;AAAM,iBAAA,IAAI,SAAS,KAAK,SAAS,CAAC,UAAU,EAAE;gBAC7C,QAAQ,GAAG,KAAK,CAAC;AAClB,aAAA;AACF,SAAA;QACD,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,cAAc,EAAE,CAAC;AAC7E,QAAA,MAAM,WAAW,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,MAAM,CAAC,SAAS,CAAC;QACzD,MAAM,SAAS,GAAG,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC9E,QAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC;QAC9C,IAAI,SAAS,GAAG,WAAW,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,KAAK,QAAQ,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,GAAG,QAAQ,CAAC,EAAE;YAC/G,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBAC1B,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AAC/B,gBAAA,IAAI,KAAK,EAAE;AACT,oBAAA,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,WAAW,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;AACvE,iBAAA;AACF,aAAA;AACF,SAAA;aAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,EAAE,EAAE;AACrC,YAAA,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,CAAC;AAC/C,SAAA;KACF;AACF;;;;"}