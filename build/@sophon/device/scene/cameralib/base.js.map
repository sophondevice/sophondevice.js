{"version":3,"file":"base.js","sources":["../../../../../libs/device/src/scene/cameralib/base.ts"],"sourcesContent":["import type { Camera, CameraInputSource, IMouseEvent, IKeyEvent } from '../camera';\r\n\r\nexport class BaseCameraModel {\r\n  /** @internal */\r\n  private _camera: Camera;\r\n  /** @internal */\r\n  private _mouseDownHandler: (evt: IMouseEvent) => void;\r\n  /** @internal */\r\n  private _mouseUpHandler: (evt: IMouseEvent) => void;\r\n  /** @internal */\r\n  private _mouseWheelHandler: (evt: IMouseEvent) => void;\r\n  /** @internal */\r\n  private _mouseMoveHandler: (evt: IMouseEvent) => void;\r\n  /** @internal */\r\n  private _keyDownHandler: (evt: IKeyEvent) => void;\r\n  /** @internal */\r\n  private _keyUpHandler: (evt: IKeyEvent) => void;\r\n  constructor() {\r\n    this._camera = null;\r\n    this._mouseDownHandler = this.onMouseDown.bind(this);\r\n    this._mouseUpHandler = this.onMouseUp.bind(this);\r\n    this._mouseWheelHandler = this.onMouseWheel.bind(this);\r\n    this._mouseMoveHandler = this.onMouseMove.bind(this);\r\n    this._keyDownHandler = this.onKeyDown.bind(this);\r\n    this._keyUpHandler = this.onKeyUp.bind(this);\r\n    this.reset();\r\n  }\r\n  /** @internal */\r\n  _getCamera() {\r\n    return this._camera;\r\n  }\r\n  /** @internal */\r\n  _setCamera(camera: Camera) {\r\n    if (this._camera !== camera) {\r\n      if (this._camera) {\r\n        this.uninstallMouseInput(this._camera.mouseInputSource);\r\n        this.uninstallKeyboardInput(this._camera.keyboardInputSource);\r\n      }\r\n      this._camera = camera;\r\n      if (this._camera) {\r\n        this.installMouseInput(this._camera.mouseInputSource);\r\n        this.installKeyboardInput(this._camera.keyboardInputSource);\r\n        this.reset();\r\n      }\r\n    }\r\n  }\r\n  installMouseInput(input: CameraInputSource) {\r\n    if (input) {\r\n      input.addEventListener('mousedown', this._mouseDownHandler);\r\n      input.addEventListener('mouseup', this._mouseUpHandler);\r\n      input.addEventListener('wheel', this._mouseWheelHandler);\r\n      input.addEventListener('mousemove', this._mouseMoveHandler);\r\n    }\r\n  }\r\n  uninstallMouseInput(input: CameraInputSource) {\r\n    if (input) {\r\n      input.removeEventListener('mousedown', this._mouseDownHandler);\r\n      input.removeEventListener('mouseup', this._mouseUpHandler);\r\n      input.removeEventListener('wheel', this._mouseWheelHandler);\r\n      input.removeEventListener('mousemove', this._mouseMoveHandler);\r\n    }\r\n  }\r\n  installKeyboardInput(input: CameraInputSource) {\r\n    if (input) {\r\n      input.addEventListener('keydown', this._keyDownHandler);\r\n      input.addEventListener('keyup', this._keyUpHandler);\r\n    }\r\n  }\r\n  uninstallKeyboardInput(input: CameraInputSource) {\r\n    if (input) {\r\n      input.removeEventListener('keydown', this._keyDownHandler);\r\n      input.removeEventListener('keyup', this._keyUpHandler);\r\n    }\r\n  }\r\n  reset(): void { }\r\n  onMouseDown(evt: IMouseEvent): void {\r\n    if (evt.target === this._camera?.mouseInputSource) {\r\n      this._onMouseDown(evt);\r\n    }\r\n  }\r\n  onMouseUp(evt: IMouseEvent): void {\r\n    if (evt.target === this._camera?.mouseInputSource) {\r\n      this._onMouseUp(evt);\r\n    }\r\n  }\r\n  onMouseWheel(evt: IMouseEvent): void {\r\n    if (evt.target === this._camera?.mouseInputSource) {\r\n      this._onMouseWheel(evt);\r\n    }\r\n  }\r\n  onMouseMove(evt: IMouseEvent): void {\r\n    if (evt.target === this._camera?.mouseInputSource) {\r\n      this._onMouseMove(evt);\r\n    }\r\n  }\r\n  onKeyDown(evt: IKeyEvent): void {\r\n    if (evt.target === this._camera?.keyboardInputSource) {\r\n      this._onKeyDown(evt);\r\n    }\r\n  }\r\n  onKeyUp(evt: IKeyEvent): void {\r\n    if (evt.target === this._camera?.keyboardInputSource) {\r\n      this._onKeyUp(evt);\r\n    }\r\n  }\r\n  update(): void { }\r\n  /** @internal */\r\n  protected _onMouseDown(evt: IMouseEvent): void { }\r\n  /** @internal */\r\n  protected _onMouseUp(evt: IMouseEvent): void { }\r\n  /** @internal */\r\n  protected _onMouseWheel(evt: IMouseEvent): void { }\r\n  /** @internal */\r\n  protected _onMouseMove(evt: IMouseEvent): void { }\r\n  /** @internal */\r\n  protected _onKeyDown(evt: IKeyEvent): void { }\r\n  /** @internal */\r\n  protected _onKeyUp(evt: IKeyEvent): void { }\r\n}\r\n"],"names":[],"mappings":"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"}