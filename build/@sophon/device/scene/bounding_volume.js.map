{"version":3,"file":"bounding_volume.js","sources":["../../../../libs/device/src/scene/bounding_volume.ts"],"sourcesContent":["import { Vector3, Matrix4x4, Frustum, AABB, Plane, ClipState } from '@sophon/base';\nimport { AABBTree } from './aabbtree';\n\nexport interface BoundingVolume {\n  clone(): BoundingVolume;\n  transform(matrix: Matrix4x4): BoundingVolume;\n  behindPlane(plane: Plane): boolean;\n  outsideFrustum(frustum: Frustum | Matrix4x4): boolean;\n  toAABB(): AABB;\n}\n\nexport interface BoundingBox extends BoundingVolume {}\n\nexport class BoundingBox extends AABB {\n  constructor();\n  constructor(box: AABB);\n  constructor(minPoint: Vector3, maxPoint: Vector3);\n  constructor(arg0?: Vector3 | AABB, arg1?: Vector3) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    super(arg0 as any, arg1);\n  }\n  clone(): BoundingVolume {\n    return new BoundingBox(this);\n  }\n  transform(matrix: Matrix4x4): BoundingVolume {\n    return new BoundingBox(AABB.transform(this, matrix));\n  }\n  outsideFrustum(frustum: Frustum | Matrix4x4): boolean {\n    return (\n      (frustum instanceof Frustum\n        ? this.getClipStateWithFrustum(frustum)\n        : this.getClipState(frustum)) === ClipState.NOT_CLIPPED\n    );\n  }\n  toAABB(): AABB {\n    return this;\n  }\n}\n\nexport interface BoundingBoxTree extends BoundingVolume {}\n\nexport class BoundingBoxTree extends AABBTree {\n  constructor();\n  constructor(aabbtree: AABBTree);\n  constructor(arg?: AABBTree) {\n    super(arg);\n  }\n  clone(): BoundingVolume {\n    return new BoundingBoxTree(this);\n  }\n  transform(matrix: Matrix4x4): BoundingVolume {\n    const newBV = new BoundingBoxTree(this);\n    newBV.transform(matrix);\n    return newBV;\n  }\n  outsideFrustum(frustum: Frustum | Matrix4x4): boolean {\n    const aabb = this.getTopLevelAABB();\n    if (aabb) {\n      return (\n        (frustum instanceof Frustum\n          ? aabb.getClipStateWithFrustum(frustum)\n          : aabb.getClipState(frustum)) === ClipState.NOT_CLIPPED\n      );\n    } else {\n      return false;\n    }\n  }\n  toAABB(): AABB {\n    return this.getTopLevelAABB();\n  }\n}\n/*\nexport class BoundingFrustum implements BoundingVolume {\n    protected _frustum: Frustum;\n    constructor ();\n    constructor (other: BoundingFrustum|Frustum|Matrix4x4);\n    constructor (arg0?: BoundingFrustum|Frustum|Matrix4x4) {\n        if (arg0 instanceof BoundingFrustum) {\n            this._frustum = arg0._frustum ? new Frustum (arg0._frustum) : null;\n        } else if (arg0 instanceof Frustum) {\n            this._frustum = new Frustum (arg0);\n        } else if (arg0 instanceof Matrix4x4) {\n            this._frustum = new Frustum (arg0);\n        } else {\n            this._frustum = null;\n        }\n    }\n    clone (): BoundingVolume {\n        return new BoundingFrustum (this);\n    }\n    transform (matrix: Matrix4x4)\n}\n*/\n"],"names":[],"mappings":";;;;AAaM,MAAO,WAAY,SAAQ,IAAI,CAAA;IAInC,WAAY,CAAA,IAAqB,EAAE,IAAc,EAAA;AAE/C,QAAA,KAAK,CAAC,IAAW,EAAE,IAAI,CAAC,CAAC;KAC1B;IACD,KAAK,GAAA;AACH,QAAA,OAAO,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC;KAC9B;AACD,IAAA,SAAS,CAAC,MAAiB,EAAA;AACzB,QAAA,OAAO,IAAI,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC;KACtD;AACD,IAAA,cAAc,CAAC,OAA4B,EAAA;AACzC,QAAA,QACE,CAAC,OAAO,YAAY,OAAO;AACzB,cAAE,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC;AACvC,cAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,SAAS,CAAC,WAAW,EACzD;KACH;IACD,MAAM,GAAA;AACJ,QAAA,OAAO,IAAI,CAAC;KACb;AACF,CAAA;AAIK,MAAO,eAAgB,SAAQ,QAAQ,CAAA;AAG3C,IAAA,WAAA,CAAY,GAAc,EAAA;QACxB,KAAK,CAAC,GAAG,CAAC,CAAC;KACZ;IACD,KAAK,GAAA;AACH,QAAA,OAAO,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;KAClC;AACD,IAAA,SAAS,CAAC,MAAiB,EAAA;AACzB,QAAA,MAAM,KAAK,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,CAAC;AACxC,QAAA,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;AACxB,QAAA,OAAO,KAAK,CAAC;KACd;AACD,IAAA,cAAc,CAAC,OAA4B,EAAA;AACzC,QAAA,MAAM,IAAI,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;AACpC,QAAA,IAAI,IAAI,EAAE;AACR,YAAA,QACE,CAAC,OAAO,YAAY,OAAO;AACzB,kBAAE,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC;AACvC,kBAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,SAAS,CAAC,WAAW,EACzD;AACH,SAAA;AAAM,aAAA;AACL,YAAA,OAAO,KAAK,CAAC;AACd,SAAA;KACF;IACD,MAAM,GAAA;AACJ,QAAA,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC;KAC/B;AACF;;;;"}