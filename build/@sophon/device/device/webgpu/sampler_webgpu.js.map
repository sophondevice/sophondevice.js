{"version":3,"file":"sampler_webgpu.js","sources":["../../../../../libs/device/src/device/webgpu/sampler_webgpu.ts"],"sourcesContent":["import { WebGPUObject } from './gpuobject_webgpu';\r\nimport { textureWrappingMap, textureFilterMap, compareFuncMap } from './constants_webgpu';\r\nimport { TextureWrapping, TextureFilter } from '../base_types';\r\nimport type { SamplerOptions, TextureSampler } from '../gpuobject';\r\nimport type { WebGPUDevice } from './device';\r\n\r\nexport class WebGPUTextureSampler extends WebGPUObject<GPUSampler> implements TextureSampler<GPUSampler> {\r\n  private _options: SamplerOptions;\r\n  constructor(device: WebGPUDevice, options: SamplerOptions) {\r\n    super(device);\r\n    this._options = Object.assign({\r\n      addressU: TextureWrapping.ClampToEdge,\r\n      addressV: TextureWrapping.ClampToEdge,\r\n      addressW: TextureWrapping.ClampToEdge,\r\n      magFilter: TextureFilter.Nearest,\r\n      minFilter: TextureFilter.Nearest,\r\n      mipFilter: TextureFilter.None,\r\n      lodMin: 0,\r\n      lodMax: 32,\r\n      compare: null,\r\n      maxAnisotropy: 1\r\n    }, options || {});\r\n    this._load();\r\n  }\r\n  get hash(): number {\r\n    return this._object ? this._device.gpuGetObjectHash(this._object) : 0;\r\n  }\r\n  get addressModeU() {\r\n    return this._options.addressU;\r\n  }\r\n  get addressModeV() {\r\n    return this._options.addressV;\r\n  }\r\n  get addressModeW() {\r\n    return this._options.addressW;\r\n  }\r\n  get magFilter() {\r\n    return this._options.magFilter;\r\n  }\r\n  get minFilter() {\r\n    return this._options.minFilter;\r\n  }\r\n  get mipFilter() {\r\n    return this._options.mipFilter;\r\n  }\r\n  get lodMin() {\r\n    return this._options.lodMin;\r\n  }\r\n  get lodMax() {\r\n    return this._options.lodMax;\r\n  }\r\n  get compare() {\r\n    return this._options.compare;\r\n  }\r\n  get maxAnisotropy() {\r\n    return this._options.maxAnisotropy;\r\n  }\r\n  destroy() {\r\n    this._object = null;\r\n  }\r\n  async restore() {\r\n    if (!this._device.isContextLost()) {\r\n      this._load();\r\n    }\r\n  }\r\n  private _load(): boolean {\r\n    this._object = this._device.gpuCreateSampler({\r\n      addressModeU: textureWrappingMap[this._options.addressU],\r\n      addressModeV: textureWrappingMap[this._options.addressV],\r\n      addressModeW: textureWrappingMap[this._options.addressW],\r\n      magFilter: textureFilterMap[this._options.magFilter],\r\n      minFilter: textureFilterMap[this._options.minFilter],\r\n      mipmapFilter: textureFilterMap[this._options.mipFilter],\r\n      lodMinClamp: this._options.lodMin,\r\n      lodMaxClamp: this._options.lodMax,\r\n      compare: compareFuncMap[this._options.compare] || undefined,\r\n      maxAnisotropy: this._options.maxAnisotropy\r\n    });\r\n    return !!this._object;\r\n  }\r\n  isSampler(): boolean {\r\n    return true;\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}